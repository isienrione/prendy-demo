<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prendy ‚Äî The OS that makes social life Effortless</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=General+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --ink:#0f0f0f;--paper:#faf9f7;--warm:#f5f0eb;--stone:#8a8578;
            --rose:#d4536a;--violet:#7c5ce0;--sage:#3d8b6e;--amber:#d4930a;
            --border:#e8e4de;--card:#ffffff;
            --serif:'Instrument Serif',Georgia,serif;
            --sans:'General Sans',-apple-system,sans-serif;
        }
        *{box-sizing:border-box;margin:0;padding:0}
        body{font-family:var(--sans);background:var(--paper);color:var(--ink);overflow-x:hidden;-webkit-font-smoothing:antialiased}
        button{cursor:pointer;font-family:var(--sans);transition:all .15s ease}
        button:active{transform:scale(.97)}
        ::selection{background:rgba(124,92,224,.15)}
        @keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
        @keyframes fadeIn{from{opacity:0}to{opacity:1}}
        @keyframes slideIn{from{opacity:0;transform:translateX(-12px)}to{opacity:1;transform:translateX(0)}}
        @keyframes spin{to{transform:rotate(360deg)}}
        @keyframes shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}
        @keyframes popIn{from{opacity:0;transform:scale(.92)}to{opacity:1;transform:scale(1)}}
        @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
        @keyframes confetti1{0%{opacity:1;transform:translate(0,0) rotate(0deg) scale(1)}100%{opacity:0;transform:translate(-40px,-80px) rotate(200deg) scale(0)}}
        @keyframes confetti2{0%{opacity:1;transform:translate(0,0) rotate(0deg) scale(1)}100%{opacity:0;transform:translate(50px,-90px) rotate(-180deg) scale(0)}}
        @keyframes confetti3{0%{opacity:1;transform:translate(0,0) rotate(0deg) scale(1)}100%{opacity:0;transform:translate(10px,-100px) rotate(150deg) scale(0)}}
        @keyframes scrollLeft{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}
        .fade-up{animation:fadeUp .5s ease forwards}
        .fade-up-d1{animation:fadeUp .5s ease .1s forwards;opacity:0}
        .fade-up-d2{animation:fadeUp .5s ease .2s forwards;opacity:0}
        .fade-up-d3{animation:fadeUp .5s ease .3s forwards;opacity:0}
        .fade-up-d4{animation:fadeUp .5s ease .4s forwards;opacity:0}
        .fade-up-d5{animation:fadeUp .5s ease .5s forwards;opacity:0}
        .card{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:28px;transition:all .2s ease}
        .card:hover{box-shadow:0 8px 30px rgba(0,0,0,.04)}
        input,textarea,select{font-family:var(--sans);font-size:15px;padding:14px 18px;border:1.5px solid var(--border);border-radius:14px;background:var(--card);color:var(--ink);width:100%;outline:none;transition:border-color .2s}
        input:focus,textarea:focus,select:focus{border-color:var(--violet)}
        .pill{display:inline-flex;align-items:center;gap:6px;padding:6px 14px;border-radius:100px;font-size:13px;font-weight:600}
        ::-webkit-scrollbar{width:6px;height:6px}
        ::-webkit-scrollbar-track{background:transparent}
        ::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
        .toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:var(--ink);color:#fff;padding:14px 28px;border-radius:14px;font-weight:600;font-size:14px;z-index:300;animation:popIn .3s ease;display:flex;align-items:center;gap:10px;box-shadow:0 12px 40px rgba(0,0,0,.15)}
        .checkbox-row{display:flex;align-items:center;gap:14px;padding:14px 16px;border-radius:14px;transition:all .15s}
        .checkbox-row:hover{background:var(--warm)}
        .custom-check{width:22px;height:22px;border-radius:7px;border:2px solid var(--border);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .15s;flex-shrink:0}
        .custom-check.checked{background:var(--sage);border-color:var(--sage)}
        .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);display:flex;align-items:center;justify-content:center;z-index:200;animation:fadeIn .2s ease;backdrop-filter:blur(4px)}
        .modal-body{animation:popIn .25s ease;max-height:90vh;overflow-y:auto}
        .booking-step{display:flex;align-items:center;gap:10px;padding:12px 0}
        .booking-step-num{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;flex-shrink:0}
        .time-slot{padding:10px 16px;border-radius:12px;border:1.5px solid var(--border);background:var(--card);font-size:14px;font-weight:500;text-align:center;cursor:pointer;transition:all .15s}
        .time-slot:hover{border-color:var(--violet)}
        .time-slot.selected{border-color:var(--violet);background:rgba(124,92,224,.06);color:var(--violet);font-weight:600}
        .carousel-track{display:flex;gap:24px;overflow-x:auto;scroll-snap-type:x mandatory;-webkit-overflow-scrolling:touch;scroll-behavior:smooth;scrollbar-width:none;padding:0 calc(50vw - 170px) 16px}
        .carousel-track::-webkit-scrollbar{display:none}
        .carousel-card{scroll-snap-align:center;flex-shrink:0;width:340px;border-radius:24px;overflow:hidden;position:relative;cursor:pointer;transition:transform .3s ease,box-shadow .3s ease,opacity .3s ease}
        .carousel-card:hover{transform:translateY(-6px);box-shadow:0 20px 60px rgba(0,0,0,0.2)}
        @media(max-width:700px){
            .grid-2{grid-template-columns:1fr!important}
            .carousel-card{width:290px}
            .carousel-track{padding:0 calc(50vw - 145px) 16px}
        }
        /* About Section */
        .about-section{position:relative;overflow:hidden}
        .about-section::before{content:'';position:absolute;top:-200px;right:-200px;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,rgba(124,92,224,0.06) 0%,transparent 70%)}
        .about-section::after{content:'';position:absolute;bottom:-200px;left:-200px;width:500px;height:500px;border-radius:50%;background:radial-gradient(circle,rgba(212,83,106,0.06) 0%,transparent 70%)}
        /* Dashboard Styles */
        .dash-grid{display:grid;gridTemplateColumns:repeat(auto-fit,minmax(280px,1fr));gap:16px}
        .dash-metric{text-align:center;padding:24px 16px}
        .dash-metric .value{font-family:var(--serif);font-size:32px;font-weight:700}
        .dash-metric .label{font-size:13px;color:var(--stone);margin-top:4px}
        .rsvp-row{display:flex;align-items:center;gap:14px;padding:14px 16px;border-radius:14px;transition:all .15s}
        .rsvp-row:hover{background:var(--warm)}
        .status-dot{width:10px;height:10px;border-radius:50%;flex-shrink:0}
        .split-input{width:80px;text-align:center;padding:8px;font-size:14px;border-radius:10px}
        .role-menu{position:absolute;top:100%;right:0;margin-top:8px;background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 12px 40px rgba(0,0,0,.1);padding:8px;min-width:220px;z-index:150;animation:popIn .2s ease}
        .role-option{display:flex;align-items:center;gap:12px;padding:12px 16px;border-radius:12px;border:none;background:transparent;width:100%;font-size:14px;font-weight:500;color:var(--ink);text-align:left;transition:all .15s}
        .role-option:hover{background:var(--warm)}
        .calendar-day{width:100%;aspect-ratio:1;border-radius:10px;border:1px solid var(--border);display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:13px;font-weight:500;transition:all .15s;cursor:default}
        .calendar-day.has-booking{background:rgba(124,92,224,.06);border-color:rgba(124,92,224,.2);color:var(--violet)}
        .calendar-day.today{border-color:var(--rose);font-weight:700}
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, useMemo } = React;

        /* =========================================
           VENDOR DB
           ========================================= */
        const VENDORS = {
            catering: [
                { id:"cat-1", name:"Mestiza Banquetes", category:"Catering", specialty:"Chilean-Peruvian fusion", rating:4.9, priceRange:"$$-$$$", area:"Providencia", img:"üçΩÔ∏è", contact:"+56 9 8234 5671", capacity:"10-200", tags:["fusion","corporate","seated"], packages:[
                    { name:"Aperitivo", desc:"Welcome bites + 2 appetizers", pricePerHead:18000, minGuests:10 },
                    { name:"Full Dinner", desc:"3-course seated dinner with wine pairing", pricePerHead:35000, minGuests:15 },
                    { name:"Cocktail Standing", desc:"8 passed canap√©s + 2 stations", pricePerHead:25000, minGuests:20 },
                ]},
                { id:"cat-2", name:"Baco Catering", category:"Catering", specialty:"Farm-to-table, seasonal", rating:4.8, priceRange:"$$$", area:"Vitacura", img:"ü•ò", contact:"+56 9 7654 3210", capacity:"20-150", tags:["organic","premium","wine-paired"], packages:[
                    { name:"Seasonal Tasting", desc:"5-course seasonal tasting menu", pricePerHead:42000, minGuests:15 },
                    { name:"Harvest Table", desc:"Family-style shared platters", pricePerHead:28000, minGuests:20 },
                ]},
                { id:"cat-3", name:"Toqui Eventos", category:"Catering", specialty:"Traditional Chilean asado", rating:4.7, priceRange:"$$", area:"Las Condes", img:"üî•", contact:"+56 9 6543 2109", capacity:"15-300", tags:["asado","casual","outdoor"], packages:[
                    { name:"Asado Cl√°sico", desc:"Full Chilean BBQ with sides & salads", pricePerHead:22000, minGuests:15 },
                    { name:"Parrilla Premium", desc:"Premium cuts + appetizers + dessert", pricePerHead:32000, minGuests:20 },
                ]},
                { id:"cat-4", name:"Quinoa & Kin", category:"Catering", specialty:"Plant-based, allergen-aware", rating:4.6, priceRange:"$$", area:"√ëu√±oa", img:"üå±", contact:"+56 9 5432 1098", capacity:"10-80", tags:["vegan","gluten-free","intimate"], packages:[
                    { name:"Plant Power", desc:"Fully vegan 3-course dinner", pricePerHead:24000, minGuests:10 },
                    { name:"Allergen-Free", desc:"Customized allergen-safe menu", pricePerHead:28000, minGuests:10 },
                ]},
                { id:"cat-5", name:"Mar Adentro Catering", category:"Catering", specialty:"Seafood & ceviche bar", rating:4.8, priceRange:"$$$", area:"Vitacura", img:"ü¶ê", contact:"+56 9 4321 6789", capacity:"15-150", tags:["seafood","ceviche","premium"], packages:[
                    { name:"Ceviche Station", desc:"3 ceviches + tiraditos + causas", pricePerHead:26000, minGuests:15 },
                    { name:"Ocean Feast", desc:"Full seafood dinner with wine", pricePerHead:40000, minGuests:20 },
                ]},
            ],
            venues: [
                { id:"ven-1", name:"Lastarria Loft", category:"Venue", specialty:"Industrial-chic event space", rating:4.8, priceRange:"$$$", area:"Lastarria", img:"üèõÔ∏è", contact:"+56 9 1234 5678", capacity:"30-120", tags:["indoor","downtown","modern"], packages:[
                    { name:"Half Day (6h)", desc:"Space + basic AV + tables/chairs", pricePerHead:0, flatRate:450000, minGuests:1 },
                    { name:"Full Day (12h)", desc:"Full setup + AV + lighting + cleanup", pricePerHead:0, flatRate:780000, minGuests:1 },
                    { name:"Full Day + Bar", desc:"Everything + stocked bar service", pricePerHead:0, flatRate:1100000, minGuests:1 },
                ]},
                { id:"ven-2", name:"Vi√±a Cousi√±o Macul", category:"Venue", specialty:"Historic vineyard estate", rating:4.9, priceRange:"$$$$", area:"Pe√±alol√©n", img:"üçá", contact:"+56 9 2345 6789", capacity:"50-400", tags:["outdoor","vineyard","premium"], packages:[
                    { name:"Garden Terrace", desc:"Outdoor terrace + vineyard views", pricePerHead:0, flatRate:900000, minGuests:1 },
                    { name:"Full Estate", desc:"Indoor salon + gardens + wine tasting", pricePerHead:0, flatRate:1800000, minGuests:1 },
                ]},
                { id:"ven-3", name:"Espacio Villanelo", category:"Venue", specialty:"Rooftop terrace, city views", rating:4.7, priceRange:"$$-$$$", area:"Bellavista", img:"üåÜ", contact:"+56 9 3456 7890", capacity:"20-80", tags:["rooftop","nightlife","views"], packages:[
                    { name:"Sunset Session", desc:"17:00-23:00 rooftop access", pricePerHead:0, flatRate:350000, minGuests:1 },
                    { name:"Full Night", desc:"17:00-02:00 with sound system", pricePerHead:0, flatRate:600000, minGuests:1 },
                ]},
                { id:"ven-4", name:"Casa Marquet", category:"Venue", specialty:"Heritage house, garden events", rating:4.6, priceRange:"$$", area:"Santiago Centro", img:"üåø", contact:"+56 9 4567 8901", capacity:"15-60", tags:["garden","intimate","heritage"], packages:[
                    { name:"Garden Party", desc:"Garden + patio, 6 hours", pricePerHead:0, flatRate:280000, minGuests:1 },
                    { name:"Full House", desc:"All rooms + garden, 10 hours", pricePerHead:0, flatRate:450000, minGuests:1 },
                ]},
                { id:"ven-5", name:"Centro Cultural Matucana", category:"Venue", specialty:"Arts & culture event hall", rating:4.7, priceRange:"$$", area:"Estaci√≥n Central", img:"üé≠", contact:"+56 9 5678 9012", capacity:"40-250", tags:["indoor","cultural","flexible"], packages:[
                    { name:"Main Hall", desc:"Open hall + stage + AV, 6h", pricePerHead:0, flatRate:520000, minGuests:1 },
                    { name:"Full Venue", desc:"Hall + lobby + terrace, 10h", pricePerHead:0, flatRate:880000, minGuests:1 },
                ]},
            ],
            drinks: [
                { id:"drk-1", name:"Wine Express CL", category:"Drinks", specialty:"Curated Chilean wine delivery", rating:4.8, priceRange:"$$", area:"All Santiago", img:"üç∑", contact:"+56 9 8765 4321", capacity:"Any", tags:["wine","delivery","bulk"], packages:[
                    { name:"House Selection", desc:"6 bottles curated mix", pricePerHead:0, flatRate:36000, minGuests:1 },
                    { name:"Premium Reserve", desc:"6 bottles premium reserve", pricePerHead:0, flatRate:72000, minGuests:1 },
                    { name:"Event Package", desc:"Custom bulk order, per bottle", pricePerHead:5500, minGuests:10 },
                ]},
                { id:"drk-2", name:"Barman Santiago", category:"Drinks", specialty:"Mobile cocktail bar & bartenders", rating:4.7, priceRange:"$$$", area:"All Santiago", img:"üç∏", contact:"+56 9 7654 3210", capacity:"20-200", tags:["cocktails","bartender","premium"], packages:[
                    { name:"Classic Bar", desc:"3 signature cocktails + spirits + bartender", pricePerHead:12000, minGuests:20 },
                    { name:"Premium Open Bar", desc:"Unlimited cocktails + 2 bartenders + setup", pricePerHead:18000, minGuests:25 },
                ]},
                { id:"drk-3", name:"Cervecer√≠a Kross", category:"Drinks", specialty:"Craft beer kegs & service", rating:4.6, priceRange:"$$", area:"All Santiago", img:"üç∫", contact:"+56 9 6543 2109", capacity:"Any", tags:["beer","craft","casual"], packages:[
                    { name:"Keg Starter", desc:"1 keg (50L) + taps + cups", pricePerHead:0, flatRate:85000, minGuests:1 },
                    { name:"Double Tap", desc:"2 kegs (different styles) + equipment", pricePerHead:0, flatRate:150000, minGuests:1 },
                ]},
                { id:"drk-4", name:"Pisco Lab", category:"Drinks", specialty:"Pisco-based cocktail experiences", rating:4.7, priceRange:"$$", area:"Providencia", img:"ü•É", contact:"+56 9 8899 1122", capacity:"15-100", tags:["pisco","tasting","chilean"], packages:[
                    { name:"Pisco Tasting", desc:"Guided tasting of 5 artisan piscos", pricePerHead:9000, minGuests:15 },
                    { name:"Sour Bar", desc:"Pisco sour station + bartender + 3h", pricePerHead:14000, minGuests:20 },
                ]},
                { id:"drk-5", name:"Juguer√≠a Fresca", category:"Drinks", specialty:"Non-alcoholic bar & mocktails", rating:4.6, priceRange:"$", area:"All Santiago", img:"üßÉ", contact:"+56 9 2233 4455", capacity:"Any", tags:["non-alcoholic","mocktails","fresh"], packages:[
                    { name:"Refresh Station", desc:"3 fresh juices + agua fresca, 3h", pricePerHead:6000, minGuests:10 },
                    { name:"Mocktail Bar", desc:"5 crafted mocktails + bartender, 4h", pricePerHead:10000, minGuests:15 },
                ]},
            ],
            entertainment: [
                { id:"ent-1", name:"DJ Catalina Ruz", category:"Entertainment", specialty:"Latin house, electronic", rating:4.9, priceRange:"$$-$$$", area:"All Santiago", img:"üéß", contact:"+56 9 1111 2222", capacity:"Any", tags:["DJ","house","dance"], packages:[
                    { name:"3-Hour Set", desc:"DJ + sound system", pricePerHead:0, flatRate:250000, minGuests:1 },
                    { name:"Full Night", desc:"DJ + sound + lights, up to 6h", pricePerHead:0, flatRate:420000, minGuests:1 },
                ]},
                { id:"ent-2", name:"Tr√≠o Austral", category:"Entertainment", specialty:"Acoustic folk & jazz trio", rating:4.7, priceRange:"$$", area:"All Santiago", img:"üéµ", contact:"+56 9 3333 4444", capacity:"Any", tags:["live","acoustic","ambient"], packages:[
                    { name:"Acoustic Set", desc:"2-hour live performance", pricePerHead:0, flatRate:180000, minGuests:1 },
                    { name:"Full Evening", desc:"3 sets across the evening", pricePerHead:0, flatRate:300000, minGuests:1 },
                ]},
                { id:"ent-3", name:"Santiago Photo Co.", category:"Entertainment", specialty:"Event photography & photobooth", rating:4.8, priceRange:"$$", area:"All Santiago", img:"üì∏", contact:"+56 9 5555 6666", capacity:"Any", tags:["photos","photobooth","memories"], packages:[
                    { name:"Photo Coverage", desc:"3h photography + edited gallery", pricePerHead:0, flatRate:200000, minGuests:1 },
                    { name:"Photo + Booth", desc:"Full coverage + photobooth + prints", pricePerHead:0, flatRate:350000, minGuests:1 },
                ]},
                { id:"ent-4", name:"Mago Andr√©s Vidal", category:"Entertainment", specialty:"Close-up magic & stage illusions", rating:4.8, priceRange:"$$-$$$", area:"All Santiago", img:"üé©", contact:"+56 9 6677 8899", capacity:"Any", tags:["magic","interactive","shows"], packages:[
                    { name:"Roaming Magic", desc:"1h close-up magic among guests", pricePerHead:0, flatRate:150000, minGuests:1 },
                    { name:"Stage Show", desc:"30-min stage performance + roaming", pricePerHead:0, flatRate:280000, minGuests:1 },
                ]},
                { id:"ent-5", name:"Banda La Feria", category:"Entertainment", specialty:"Cumbia, salsa & Latin pop live band", rating:4.7, priceRange:"$$$", area:"All Santiago", img:"üé∫", contact:"+56 9 9900 1122", capacity:"Any", tags:["live-band","latin","dance"], packages:[
                    { name:"Party Set", desc:"2h live set, 6-piece band", pricePerHead:0, flatRate:380000, minGuests:1 },
                    { name:"Full Night", desc:"3 sets + MC + sound & lights, 5h", pricePerHead:0, flatRate:650000, minGuests:1 },
                ]},
            ],
            staff: [
                { id:"stf-1", name:"Servicio Premium CL", category:"Staff", specialty:"Waitstaff, bartenders, setup crew", rating:4.7, priceRange:"$$", area:"All Santiago", img:"ü§µ", contact:"+56 9 7777 8888", capacity:"Any", tags:["waitstaff","professional","bilingual"], packages:[
                    { name:"Basic Crew", desc:"2 servers + 1 setup, 6h", pricePerHead:0, flatRate:180000, minGuests:1 },
                    { name:"Full Service", desc:"4 servers + 1 bartender + 2 setup, 8h", pricePerHead:0, flatRate:420000, minGuests:1 },
                    { name:"Premium", desc:"6 servers + 2 bartenders + 3 setup, 10h", pricePerHead:0, flatRate:720000, minGuests:1 },
                ]},
                { id:"stf-2", name:"Azafatas Santiago", category:"Staff", specialty:"Event hostesses & guest reception", rating:4.6, priceRange:"$$", area:"All Santiago", img:"üíÅ", contact:"+56 9 3344 5566", capacity:"Any", tags:["hostess","reception","bilingual"], packages:[
                    { name:"Welcome Duo", desc:"2 hostesses, 5h, guest check-in", pricePerHead:0, flatRate:140000, minGuests:1 },
                    { name:"Full Reception", desc:"4 hostesses + coordinator, 8h", pricePerHead:0, flatRate:320000, minGuests:1 },
                ]},
                { id:"stf-3", name:"CleanPro Eventos", category:"Staff", specialty:"Post-event cleaning & teardown", rating:4.7, priceRange:"$-$$", area:"All Santiago", img:"üßπ", contact:"+56 9 4455 6677", capacity:"Any", tags:["cleanup","teardown","overnight"], packages:[
                    { name:"Standard Clean", desc:"Post-event cleaning, up to 200m¬≤", pricePerHead:0, flatRate:120000, minGuests:1 },
                    { name:"Deep Clean + Teardown", desc:"Full teardown + deep cleaning, any size", pricePerHead:0, flatRate:250000, minGuests:1 },
                ]},
                { id:"stf-4", name:"Seguridad √âlite", category:"Staff", specialty:"Event security & crowd management", rating:4.8, priceRange:"$$-$$$", area:"All Santiago", img:"üõ°Ô∏è", contact:"+56 9 5566 7788", capacity:"Any", tags:["security","crowd-control","professional"], packages:[
                    { name:"Basic Detail", desc:"2 guards, 6h", pricePerHead:0, flatRate:160000, minGuests:1 },
                    { name:"Full Security", desc:"4 guards + coordinator, 8h", pricePerHead:0, flatRate:380000, minGuests:1 },
                ]},
            ]
        };

        /* =========================================
           SHOWCASE EVENTS DATA
           ========================================= */
        const SHOWCASE_EVENTS = [
            {
                title: "Vendimia Gala 2025",
                subtitle: "Annual harvest celebration",
                location: "Vi√±a Cousi√±o Macul",
                guests: 280,
                type: "Corporate Gala",
                gradient: "linear-gradient(135deg, #2d1b69 0%, #7c3aed 50%, #a855f7 100%)",
                photo: "https://images.unsplash.com/photo-1519671482749-fd09be7ccebf?w=680&h=480&fit=crop&q=80",
                stats: { satisfaction: "98%", vendors: 12, saved: "47h" },
                quote: "Prendy turned what used to take our team 3 weeks into 2 days.",
            },
            {
                title: "TechStars Santiago Demo Day",
                subtitle: "Startup showcase afterparty",
                location: "Espacio Villanelo, Bellavista",
                guests: 150,
                type: "Corporate Meetup",
                gradient: "linear-gradient(135deg, #0f172a 0%, #1e40af 50%, #3b82f6 100%)",
                photo: "https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=680&h=480&fit=crop&q=80",
                stats: { satisfaction: "97%", vendors: 8, saved: "32h" },
                quote: "The grocery ordering alone saved us a full day of running errands.",
            },
            {
                title: "Boda Mart√≠nez-Soto",
                subtitle: "Garden wedding reception",
                location: "Casa Marquet, Santiago Centro",
                guests: 90,
                type: "Wedding Reception",
                gradient: "linear-gradient(135deg, #831843 0%, #be185d 50%, #f472b6 100%)",
                photo: "https://images.unsplash.com/photo-1519741497674-611481863552?w=680&h=480&fit=crop&q=80",
                stats: { satisfaction: "100%", vendors: 9, saved: "52h" },
                quote: "Every single vendor was perfect. The timeline ran like clockwork.",
            },
            {
                title: "Cumplea√±os #30 Catalina",
                subtitle: "Rooftop birthday bash",
                location: "Espacio Villanelo, Bellavista",
                guests: 65,
                type: "Birthday Party",
                gradient: "linear-gradient(135deg, #92400e 0%, #d97706 50%, #fbbf24 100%)",
                photo: "https://images.unsplash.com/photo-1530103862676-de8c9debad1d?w=680&h=480&fit=crop&q=80",
                stats: { satisfaction: "99%", vendors: 6, saved: "18h" },
                quote: "I just picked the vibe and Prendy handled literally everything else.",
            },
            {
                title: "Asado de Fin de A√±o NotCo",
                subtitle: "End-of-year team celebration",
                location: "Vi√±a Cousi√±o Macul",
                guests: 200,
                type: "Corporate Event",
                gradient: "linear-gradient(135deg, #064e3b 0%, #059669 50%, #34d399 100%)",
                photo: "https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=680&h=480&fit=crop&q=80",
                stats: { satisfaction: "96%", vendors: 10, saved: "38h" },
                quote: "200 people, 10 vendors, zero stress. That's the Prendy difference.",
            },
            {
                title: "Cena Privada Embajada",
                subtitle: "Diplomatic dinner for 40",
                location: "Lastarria Loft",
                guests: 40,
                type: "Dinner Party",
                gradient: "linear-gradient(135deg, #1c1917 0%, #44403c 50%, #78716c 100%)",
                photo: "https://images.unsplash.com/photo-1517457373958-b7bdd4587205?w=680&h=480&fit=crop&q=80",
                stats: { satisfaction: "100%", vendors: 7, saved: "25h" },
                quote: "The level of detail in the blueprint was better than our usual agency.",
            },
        ];

        /* =========================================
           PLATFORMS & GROCERY DB (same as v2)
           ========================================= */
        const PLATFORMS = {
            lider:{ name:"Lider.cl", icon:"üõí", color:"#0033a0", bgLight:"rgba(0,51,160,0.06)", description:"Best for bulk groceries", searchUrl:(q)=>`https://www.lider.cl/supermercado/search?Ntt=${encodeURIComponent(q)}`, delivery:"Same-day / Next-day", minOrder:"$15.000 CLP" },
            jumbo:{ name:"Jumbo.cl", icon:"üè™", color:"#e21836", bgLight:"rgba(226,24,54,0.06)", description:"Premium & imported", searchUrl:(q)=>`https://www.jumbo.cl/busqueda?ft=${encodeURIComponent(q)}`, delivery:"Same-day / Scheduled", minOrder:"$20.000 CLP" },
            cornershop:{ name:"Cornershop", icon:"üöó", color:"#ff4438", bgLight:"rgba(255,68,56,0.06)", description:"Multi-store, same-day", searchUrl:(q)=>`https://cornershopapp.com/search?query=${encodeURIComponent(q)}`, delivery:"1-3 hours", minOrder:"None" },
            rappi:{ name:"Rappi", icon:"üß°", color:"#ff441f", bgLight:"rgba(255,68,31,0.06)", description:"Fast drinks & last-minute", searchUrl:(q)=>`https://www.rappi.cl/search?term=${encodeURIComponent(q)}`, delivery:"30-60 min", minOrder:"None" },
            ubereats:{ name:"Uber Eats", icon:"üçî", color:"#06c167", bgLight:"rgba(6,193,103,0.06)", description:"Prepared food & trays", searchUrl:(q)=>`https://www.ubereats.com/cl/search?q=${encodeURIComponent(q)}`, delivery:"30-60 min", minOrder:"Varies" },
        pedidosya:{
  name:"PedidosYa",
  icon:"üõµ",
  color:"#ff1744",
  bgLight:"rgba(255,23,68,0.06)",
  description:"Fast party supplies & last-minute needs",
  searchUrl:(q)=>`https://www.pedidosya.cl/buscar?search=${encodeURIComponent(q)}`,
  delivery:"30-90 min",
  minOrder:"Varies"
},
mercadolibre:{
  name:"Mercado Libre",
  icon:"üì¶",
  color:"#ffe600",
  bgLight:"rgba(255,230,0,0.10)",
  description:"Equipment & rentals (chairs, benches, lights)",
  searchUrl:(q)=>`https://listado.mercadolibre.cl/${encodeURIComponent(q)}`,
  delivery:"1-3 days / Pick-up",
  minOrder:"Varies"
},

        };

        const GROCERY_PRICES = {
            "empanadas":{unit_price:1200,store:"lider",searchTerm:"empanadas"},"main protein":{unit_price:6500,store:"lider",searchTerm:"carne vacuno"},
            "beef":{unit_price:7990,store:"jumbo",searchTerm:"lomo vetado"},"chicken":{unit_price:3490,store:"lider",searchTerm:"pollo entero"},
            "salad":{unit_price:2500,store:"lider",searchTerm:"ensalada mix"},"dessert":{unit_price:2800,store:"jumbo",searchTerm:"torta postre"},
            "wine":{unit_price:5990,store:"lider",searchTerm:"vino tinto reserva"},"beer":{unit_price:990,store:"rappi",searchTerm:"cerveza"},
            "soft drinks":{unit_price:1490,store:"lider",searchTerm:"bebida"},"juice":{unit_price:1990,store:"lider",searchTerm:"jugo natural"},
            "water":{unit_price:590,store:"lider",searchTerm:"agua mineral"},"ice":{unit_price:1990,store:"rappi",searchTerm:"hielo"},
            "napkin":{unit_price:200,store:"lider",searchTerm:"servilletas"},"bread":{unit_price:1800,store:"lider",searchTerm:"pan"},
            "cheese":{unit_price:8990,store:"jumbo",searchTerm:"queso"},"lemons":{unit_price:1290,store:"lider",searchTerm:"limones"},
            "pisco":{unit_price:7990,store:"rappi",searchTerm:"pisco"},
        };
        function matchItemToStore(n){
    const l = n.toLowerCase();
    for(const [k,v] of Object.entries(GROCERY_PRICES)){
        if(l.includes(k)) return v;
    }
    if(l.includes("wine")) return {unit_price:5990,store:"lider",searchTerm:n};
    if(l.includes("beer")) return {unit_price:990,store:"rappi",searchTerm:n};
    if(l.includes("ice")) return {unit_price:1990,store:"rappi",searchTerm:"hielo"};
    return {unit_price:3000,store:"lider",searchTerm:n};
}

function buildShoppingList(supplies, blueprintText){
    const items = [];

    // If we don't have a structured `supplies` object (fallback-style),
    // but we DO have a text blueprint from the Netlify function, extract catalog items from it.
    if ((!supplies || Object.keys(supplies || {}).length === 0) && typeof blueprintText === "string" && blueprintText.trim()) {
        const seen = new Set();
        const re = /([^\n\r(]{3,}?)\s*\(id=([a-zA-Z0-9\-_]+)\)/g;
        let m;
        let idCounter = 0;
        while ((m = re.exec(blueprintText)) !== null) {
            const name = (m[1] || "").trim();
            const pid = (m[2] || "").trim();
            if (!pid || seen.has(pid)) continue;
            seen.add(pid);
            items.push({
                id: `bp-${idCounter++}`,
                store: "catalog",
                name: `${name} (id=${pid})`,
                quantity: "",
                unit: "",
                estimatedPrice: 0,
                checked: false
            });
        }
        // If we found at least a few catalog items, return them as the shopping list.
        if (items.length) return items;
    }
    let id = 0;

   for (const [cat, list] of Object.entries(supplies || {})) {
    for (const item of (Array.isArray(list) ? list : [])) {


            // 1Ô∏è‚É£ Try AI-provided store
            const aiStore =
                item.preferred_store ||
                (Array.isArray(item.suggestedStores) && item.suggestedStores.length
                    ? item.suggestedStores[0]
                    : null);

            // 2Ô∏è‚É£ Get pricing fallback
            const matched = matchItemToStore(item.item);

            // 3Ô∏è‚É£ Final store decision
            const finalStore = aiStore || matched.store;

            items.push({
                id: id++,
                name: item.item,
                quantity: item.quantity,
                unit: item.unit,
                note: item.note,
                category: cat,
                store: finalStore,
                searchTerm: matched.searchTerm,
                estimatedPrice: matched.unit_price * item.quantity,
                unitPrice: matched.unit_price,
                checked: false
            });
        }
    }

    return items;
}

        /* =========================================
           AI & FALLBACK GENERATORS
           ========================================= */
        async function generateBlueprint(data) {
  const res = await fetch('/.netlify/functions/blueprint', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      eventType: 'adult_birthday_home',
      guestCount: data.guests || 20,
      budgetCLP: data.budget || 0,
      location: data.location || 'Santiago',
      notes: data.notes || '',
    }),
  });

  if (!res.ok) {
    throw new Error('Blueprint HTTP ' + res.status);
  }

  // IMPORTANT: the handler already returns the blueprint object as the body
  const bp = await res.json();
  return bp;  // <‚Äî not bp.blueprint
}

        

        function generateFallback(formData) {
            const g=parseInt(formData.guestCount)||30, b=parseInt(formData.budget)||2000000;
            return {
                summary:`A ${formData.vibe.toLowerCase()} ${formData.type.toLowerCase()} for ${g} guests in ${formData.setting==='outdoor'?'an outdoor Santiago setting':'a stylish indoor venue'}.`,
                timeline:[{time:"14:00",task:"Vendor arrival & venue setup",owner:"Setup crew"},{time:"16:00",task:"Sound check & table dressing",owner:"Entertainment + Staff"},{time:"17:00",task:"Catering arrives, kitchen prep",owner:"Caterer"},{time:"18:30",task:"Final walkthrough & lighting",owner:"You"},{time:"19:00",task:"Guests arrive ‚Äî welcome drinks",owner:"Bartender"},{time:"19:45",task:"Dinner service begins",owner:"Waitstaff"},{time:"21:00",task:"Dessert & toasts",owner:"You + Staff"},{time:"22:00",task:"Music & dancing",owner:"DJ / Band"},{time:"00:00",task:"Wind down, guest departure",owner:"You"},{time:"00:30",task:"Cleanup & teardown",owner:"Setup crew"}],
                supplies:{
                    food:[{item:"Empanadas (appetizer)",quantity:g*3,unit:"pcs",note:"Mix of pino & queso"},{item:"Main protein",quantity:Math.ceil(g*.3),unit:"kg",note:"300g per person"},{item:"Side salads",quantity:Math.ceil(g/8),unit:"bowls",note:"Seasonal Chilean"},{item:"Bread & butter",quantity:Math.ceil(g/5),unit:"kg",note:"Marraqueta"},{item:"Cheese board",quantity:Math.ceil(g/10),unit:"kg",note:"Mix local & imported"},{item:"Dessert portions",quantity:g,unit:"pcs",note:"Tres leches or alfajores"}],
                    drinks:[{item:"Wine bottles (red)",quantity:Math.ceil(g*.23),unit:"bottles",note:"Carmen√®re or Cabernet"},{item:"Wine bottles (white)",quantity:Math.ceil(g*.1),unit:"bottles",note:"Sauvignon Blanc"},{item:"Beer",quantity:Math.ceil(g*.8),unit:"bottles",note:"Mix craft & pilsner"},{item:"Soft drinks",quantity:Math.ceil(g*.5),unit:"liters",note:""},{item:"Water (still)",quantity:Math.ceil(g*.5),unit:"liters",note:""},{item:"Water (sparkling)",quantity:Math.ceil(g*.25),unit:"liters",note:""},{item:"Juice",quantity:Math.ceil(g*.3),unit:"liters",note:"Orange & pineapple"},{item:"Ice",quantity:Math.ceil(g*.5),unit:"kg",note:"Order 50% more"}],
                    equipment:[{item:"Tables (8-seat)",quantity:Math.ceil(g/8),unit:"pcs",note:""},{item:"Chairs",quantity:Math.ceil(g*1.1),unit:"pcs",note:"10% buffer"},{item:"Glass sets",quantity:Math.ceil(g*2.5),unit:"pcs",note:""},{item:"Napkin sets",quantity:Math.ceil(g*2),unit:"pcs",note:""},{item:"Plates",quantity:Math.ceil(g*1.2),unit:"pcs",note:""}],
                },
                budget:{venue:{amount:Math.round(b*.30),pct:30},food:{amount:Math.round(b*.30),pct:30},drinks:{amount:Math.round(b*.15),pct:15},entertainment:{amount:Math.round(b*.10),pct:10},staff:{amount:Math.round(b*.10),pct:10},misc:{amount:Math.round(b*.05),pct:5}},
                staffing:{servers:Math.ceil(g/12),bartenders:Math.ceil(g/30),setup_crew:Math.ceil(g/25)+1},
                tips:["Book your venue at least 3 weeks ahead ‚Äî Santiago fills fast on weekends.","Chilean gatherings run late. Plan food to last and have coffee by 23:00.","Confirm vendor arrival times the day before via WhatsApp."],
                risks:["Weather: If outdoor, have a carpa backup ‚Äî Santiago evenings get cold.","No-shows: Expect 10-15% drop-off. Order for 90% of RSVPs."],
            };
        }

        function matchVendors(formData) {
            const setting=formData.setting,vibe=formData.vibe,dietary=(formData.dietary||"").toLowerCase();
            function score(v){let s=v.rating*10;if(dietary.includes("vegan")&&v.tags.includes("vegan"))s+=20;if(setting==="outdoor"&&v.tags.includes("outdoor"))s+=15;if(setting==="indoor"&&v.tags.includes("indoor"))s+=15;if(vibe==="Casual & Relaxed"&&v.tags.includes("casual"))s+=10;if(vibe==="Elegant & Refined"&&v.tags.includes("premium"))s+=10;if(vibe==="Party & High-Energy"&&v.tags.includes("dance"))s+=10;return s;}
            const pick=(arr)=>[...arr].sort((a,b)=>score(b)-score(a)).slice(0,2);
            return{catering:pick(VENDORS.catering),venues:pick(VENDORS.venues),drinks:pick(VENDORS.drinks),entertainment:pick(VENDORS.entertainment),staff:VENDORS.staff};
        }

        const fmtCLP=(n)=>"$"+Math.round(n).toLocaleString("es-CL");

        /* =========================================
           ICON COMPONENT
           ========================================= */
        const Icon = ({ name, size = 24, color = "currentColor" }) => {
            const icons = {
                heart: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>,
                rocket: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"/><path d="M12 15l-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"/><path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"/><path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"/></svg>,
                blueprint: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 6h4"/><path d="M2 10h4"/><path d="M2 14h4"/><path d="M2 18h4"/><rect x="6" y="3" width="16" height="18" rx="2"/><path d="M10 8h8"/><path d="M10 12h8"/><path d="M10 16h4"/></svg>,
                zap: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
                users: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
                globe: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>,
            };
            return icons[name] || null;
        };

        /* =========================================
           SMALL UI COMPONENTS
           ========================================= */
        const Nav=({view,setView})=>{
            const [showRoleMenu,setShowRoleMenu]=useState(false);
            const roleMenuRef=useRef(null);
            useEffect(()=>{
                const handleClick=(e)=>{if(roleMenuRef.current&&!roleMenuRef.current.contains(e.target))setShowRoleMenu(false);};
                document.addEventListener('click',handleClick);return()=>document.removeEventListener('click',handleClick);
            },[]);
            const dashboards=[
                {id:'host-dashboard',icon:'üéâ',label:'Host Dashboard',desc:'RSVP tracking & cost splitting'},
                {id:'vendor-dashboard',icon:'üè™',label:'Vendor Dashboard',desc:'Bookings & revenue'},
                {id:'venue-dashboard',icon:'üèõÔ∏è',label:'Venue Dashboard',desc:'Calendar & availability'},
            ];
            const activeDash=dashboards.find(d=>d.id===view);
            return (
                <nav style={{padding:"16px 32px",display:"flex",justifyContent:"space-between",alignItems:"center",background:"rgba(250,249,247,0.85)",backdropFilter:"blur(16px)",borderBottom:"1px solid var(--border)",position:"sticky",top:0,zIndex:100}}>
                    <div onClick={()=>setView('landing')} style={{cursor:"pointer",display:"flex",alignItems:"center",gap:10}}>
                        <div style={{width:32,height:32,borderRadius:10,background:"linear-gradient(135deg,var(--rose),var(--violet))",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:14,fontWeight:700}}>P</div>
                        <span style={{fontFamily:"var(--serif)",fontSize:22}}>Prendy</span>
                    </div>
                    <div style={{display:"flex",gap:10,alignItems:"center"}}>
                        {view!=='onboarding'&&<button onClick={()=>setView('onboarding')} style={{padding:"10px 24px",borderRadius:100,border:"none",background:"var(--ink)",color:"#fff",fontWeight:600,fontSize:14}}>New Blueprint</button>}
                        <div ref={roleMenuRef} style={{position:"relative"}}>
                            <button onClick={(e)=>{e.stopPropagation();setShowRoleMenu(!showRoleMenu);}} style={{padding:"10px 18px",borderRadius:100,border:"1.5px solid var(--border)",background:activeDash?"rgba(124,92,224,.06)":"var(--card)",fontWeight:600,fontSize:13,display:"flex",alignItems:"center",gap:6,color:activeDash?"var(--violet)":"var(--ink)"}}>
                                {activeDash?activeDash.icon:'üë§'} {activeDash?activeDash.label:'Dashboards'}
                            </button>
                            {showRoleMenu && (
                                <div className="role-menu">
                                    <div style={{padding:"8px 16px 4px",fontSize:11,fontWeight:600,color:"var(--stone)",textTransform:"uppercase",letterSpacing:".05em"}}>Switch Dashboard</div>
                                    {dashboards.map(d=>(
                                        <button key={d.id} className="role-option" onClick={()=>{setView(d.id);setShowRoleMenu(false);}} style={{background:view===d.id?"var(--warm)":"transparent"}}>
                                            <span style={{fontSize:20}}>{d.icon}</span>
                                            <div>
                                                <div style={{fontWeight:600,fontSize:14}}>{d.label}</div>
                                                <div style={{fontSize:11,color:"var(--stone)"}}>{d.desc}</div>
                                            </div>
                                        </button>
                                    ))}
                                    <div style={{borderTop:"1px solid var(--border)",margin:"4px 0"}}/>
                                    <button className="role-option" onClick={()=>{setView('landing');setShowRoleMenu(false);}}>
                                        <span style={{fontSize:20}}>üè†</span>
                                        <div><div style={{fontWeight:600,fontSize:14}}>Back to Home</div></div>
                                    </button>
                                </div>
                            )}
                        </div>
                    </div>
                </nav>
            );
        };
        const ProgressBar=({step,total})=>(<div style={{display:"flex",gap:6,marginBottom:40}}>{Array.from({length:total},(_,i)=>(<div key={i} style={{flex:1,height:4,borderRadius:2,background:i<=step?"var(--violet)":"var(--border)",transition:"background .3s"}}/>))}</div>);
        const OptionCard=({selected,onClick,emoji,title,desc})=>(<div onClick={onClick} className="card" style={{cursor:"pointer",borderColor:selected?"var(--violet)":"var(--border)",background:selected?"rgba(124,92,224,0.04)":"var(--card)",display:"flex",gap:14,alignItems:"center"}}><span style={{fontSize:28}}>{emoji}</span><div><div style={{fontWeight:600,fontSize:15}}>{title}</div>{desc&&<div style={{fontSize:13,color:"var(--stone)",marginTop:2}}>{desc}</div>}</div>{selected&&<div style={{marginLeft:"auto",color:"var(--violet)",fontSize:18}}>‚úì</div>}</div>);
        const Chip=({selected,onClick,children})=>(<button onClick={onClick} style={{padding:"10px 20px",borderRadius:100,border:selected?"2px solid var(--violet)":"1.5px solid var(--border)",background:selected?"rgba(124,92,224,0.06)":"var(--card)",color:selected?"var(--violet)":"var(--ink)",fontWeight:selected?600:500,fontSize:14}}>{children}</button>);
        const StatCard=({label,value,sub,color})=>(<div className="card" style={{textAlign:"center"}}><div style={{fontSize:13,color:"var(--stone)",marginBottom:8,fontWeight:500}}>{label}</div><div style={{fontSize:32,fontWeight:700,fontFamily:"var(--serif)",color:color||"var(--ink)"}}>{value}</div>{sub&&<div style={{fontSize:12,color:"var(--stone)",marginTop:4}}>{sub}</div>}</div>);
        const Toast=({message,visible})=>visible?<div className="toast">{message}</div>:null;

        /* =========================================
           BOOKING MODAL
           ========================================= */
        const BookingModal = ({ vendor, eventData, onClose, onConfirm }) => {
            const [step, setStep] = useState(0); // 0=package, 1=details, 2=confirm, 3=done
            const [selectedPkg, setSelectedPkg] = useState(null);
            const [bookingDate, setBookingDate] = useState(eventData?.date || '');
            const [bookingTime, setBookingTime] = useState('');
            const [bookingNotes, setBookingNotes] = useState('');
            const [guestCount, setGuestCount] = useState(parseInt(eventData?.guestCount) || 30);
            const bookingRef = useRef(`PRN-${Date.now().toString(36).toUpperCase().slice(-6)}`);

            const timeSlots = ['14:00','15:00','16:00','17:00','18:00','19:00','20:00','21:00'];

            const calcPrice = () => {
                if (!selectedPkg) return 0;
                if (selectedPkg.flatRate) return selectedPkg.flatRate;
                return selectedPkg.pricePerHead * guestCount;
            };

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="card modal-body" onClick={e=>e.stopPropagation()} style={{maxWidth:520,width:"92%",padding:0,overflow:"hidden"}}>
                        {/* Header */}
                        <div style={{padding:"24px 28px 20px",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:14}}>
                            <div style={{fontSize:32,width:48,height:48,borderRadius:14,background:"var(--warm)",display:"flex",alignItems:"center",justifyContent:"center"}}>{vendor.img}</div>
                            <div style={{flex:1}}>
                                <div style={{fontWeight:700,fontSize:16}}>{vendor.name}</div>
                                <div style={{fontSize:13,color:"var(--stone)"}}>{vendor.specialty}</div>
                            </div>
                            <button onClick={onClose} style={{width:32,height:32,borderRadius:10,border:"1px solid var(--border)",background:"transparent",fontSize:16,display:"flex",alignItems:"center",justifyContent:"center"}}>√ó</button>
                        </div>

                        <div style={{padding:"24px 28px"}}>
                            {/* Step indicators */}
                            {step < 3 && (
                                <div style={{display:"flex",gap:6,marginBottom:24}}>
                                    {['Package','Details','Confirm'].map((s,i)=>(
                                        <div key={s} style={{display:"flex",alignItems:"center",gap:6,flex:1}}>
                                            <div style={{width:24,height:24,borderRadius:"50%",background:i<=step?"var(--violet)":"var(--border)",color:i<=step?"#fff":"var(--stone)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700}}>{i+1}</div>
                                            <span style={{fontSize:12,fontWeight:i===step?600:400,color:i<=step?"var(--ink)":"var(--stone)"}}>{s}</span>
                                        </div>
                                    ))}
                                </div>
                            )}

                            {/* Step 0: Package selection */}
                            {step === 0 && (
                                <div className="fade-up">
                                    <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:16}}>Choose a package</h3>
                                    {vendor.packages.map((pkg,i)=>(
                                        <div key={i} onClick={()=>setSelectedPkg(pkg)} className="card" style={{marginBottom:10,cursor:"pointer",padding:"18px 20px",borderColor:selectedPkg===pkg?"var(--violet)":"var(--border)",background:selectedPkg===pkg?"rgba(124,92,224,0.04)":"var(--card)"}}>
                                            <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start"}}>
                                                <div>
                                                    <div style={{fontWeight:600,fontSize:15}}>{pkg.name}</div>
                                                    <div style={{fontSize:13,color:"var(--stone)",marginTop:2}}>{pkg.desc}</div>
                                                </div>
                                                <div style={{textAlign:"right",flexShrink:0,marginLeft:12}}>
                                                    <div style={{fontWeight:700,fontSize:15,color:"var(--violet)"}}>
                                                        {pkg.flatRate ? fmtCLP(pkg.flatRate) : `${fmtCLP(pkg.pricePerHead)}/pp`}
                                                    </div>
                                                    {pkg.minGuests > 1 && <div style={{fontSize:11,color:"var(--stone)"}}>min {pkg.minGuests} guests</div>}
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                    <button onClick={()=>selectedPkg&&setStep(1)} disabled={!selectedPkg} style={{width:"100%",padding:"14px",borderRadius:14,border:"none",background:selectedPkg?"var(--ink)":"var(--border)",color:selectedPkg?"#fff":"var(--stone)",fontWeight:600,fontSize:15,marginTop:8}}>
                                        Continue ‚Üí
                                    </button>
                                </div>
                            )}

                            {/* Step 1: Date/Time/Details */}
                            {step === 1 && (
                                <div className="fade-up">
                                    <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:16}}>Event details</h3>

                                    <label style={{fontWeight:600,fontSize:14,display:"block",marginBottom:8}}>Date</label>
                                    <input type="date" value={bookingDate} onChange={e=>setBookingDate(e.target.value)} style={{marginBottom:20}}/>

                                    <label style={{fontWeight:600,fontSize:14,display:"block",marginBottom:8}}>Start Time</label>
                                    <div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:8,marginBottom:20}}>
                                        {timeSlots.map(t=>(
                                            <div key={t} className={`time-slot ${bookingTime===t?'selected':''}`} onClick={()=>setBookingTime(t)}>{t}</div>
                                        ))}
                                    </div>

                                    {selectedPkg.pricePerHead > 0 && (
                                        <>
                                            <label style={{fontWeight:600,fontSize:14,display:"block",marginBottom:8}}>Guest Count</label>
                                            <input type="number" value={guestCount} onChange={e=>setGuestCount(Math.max(selectedPkg.minGuests,parseInt(e.target.value)||0))} min={selectedPkg.minGuests} style={{marginBottom:20}}/>
                                        </>
                                    )}

                                    <label style={{fontWeight:600,fontSize:14,display:"block",marginBottom:8}}>Special Requests</label>
                                    <textarea value={bookingNotes} onChange={e=>setBookingNotes(e.target.value)} placeholder="Any allergies, setup preferences, timing notes..." rows={3} style={{resize:"vertical",marginBottom:20}}/>

                                    <div style={{display:"flex",gap:10}}>
                                        <button onClick={()=>setStep(0)} style={{flex:1,padding:"14px",borderRadius:14,border:"1.5px solid var(--border)",background:"transparent",fontWeight:600,fontSize:15}}>‚Üê Back</button>
                                        <button onClick={()=>bookingDate&&bookingTime&&setStep(2)} disabled={!bookingDate||!bookingTime} style={{flex:2,padding:"14px",borderRadius:14,border:"none",background:(bookingDate&&bookingTime)?"var(--ink)":"var(--border)",color:(bookingDate&&bookingTime)?"#fff":"var(--stone)",fontWeight:600,fontSize:15}}>Review Booking ‚Üí</button>
                                    </div>
                                </div>
                            )}

                            {/* Step 2: Confirmation review */}
                            {step === 2 && (
                                <div className="fade-up">
                                    <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:20}}>Confirm your booking</h3>

                                    <div style={{background:"var(--warm)",borderRadius:16,padding:20,marginBottom:20}}>
                                        <div style={{display:"flex",justifyContent:"space-between",marginBottom:12}}>
                                            <span style={{color:"var(--stone)",fontSize:14}}>Vendor</span>
                                            <span style={{fontWeight:600,fontSize:14}}>{vendor.name}</span>
                                        </div>
                                        <div style={{display:"flex",justifyContent:"space-between",marginBottom:12}}>
                                            <span style={{color:"var(--stone)",fontSize:14}}>Package</span>
                                            <span style={{fontWeight:600,fontSize:14}}>{selectedPkg.name}</span>
                                        </div>
                                        <div style={{display:"flex",justifyContent:"space-between",marginBottom:12}}>
                                            <span style={{color:"var(--stone)",fontSize:14}}>Date</span>
                                            <span style={{fontWeight:600,fontSize:14}}>{new Date(bookingDate+'T12:00').toLocaleDateString('es-CL',{weekday:'short',month:'short',day:'numeric'})}</span>
                                        </div>
                                        <div style={{display:"flex",justifyContent:"space-between",marginBottom:12}}>
                                            <span style={{color:"var(--stone)",fontSize:14}}>Time</span>
                                            <span style={{fontWeight:600,fontSize:14}}>{bookingTime}</span>
                                        </div>
                                        {selectedPkg.pricePerHead > 0 && (
                                            <div style={{display:"flex",justifyContent:"space-between",marginBottom:12}}>
                                                <span style={{color:"var(--stone)",fontSize:14}}>Guests</span>
                                                <span style={{fontWeight:600,fontSize:14}}>{guestCount}</span>
                                            </div>
                                        )}
                                        {bookingNotes && (
                                            <div style={{borderTop:"1px solid var(--border)",paddingTop:12,marginTop:4}}>
                                                <span style={{color:"var(--stone)",fontSize:13}}>Notes: </span>
                                                <span style={{fontSize:13}}>{bookingNotes}</span>
                                            </div>
                                        )}
                                    </div>

                                    {/* Price */}
                                    <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",background:"rgba(124,92,224,0.04)",borderRadius:14,border:"1.5px solid rgba(124,92,224,0.12)",marginBottom:20}}>
                                        <span style={{fontWeight:600,fontSize:15}}>Estimated Total</span>
                                        <span style={{fontFamily:"var(--serif)",fontSize:28,color:"var(--violet)"}}>{fmtCLP(calcPrice())}</span>
                                    </div>

                                    <div style={{fontSize:12,color:"var(--stone)",marginBottom:20,lineHeight:1.5}}>
                                        By confirming, a booking request will be sent to {vendor.name} via WhatsApp. Final pricing will be confirmed directly with the vendor. No payment is charged through Prendy.
                                    </div>

                                    <div style={{display:"flex",gap:10}}>
                                        <button onClick={()=>setStep(1)} style={{flex:1,padding:"14px",borderRadius:14,border:"1.5px solid var(--border)",background:"transparent",fontWeight:600,fontSize:15}}>‚Üê Back</button>
                                        <button onClick={()=>{setStep(3);onConfirm&&onConfirm({vendor,pkg:selectedPkg,date:bookingDate,time:bookingTime,guests:guestCount,notes:bookingNotes,price:calcPrice(),ref:bookingRef.current});}} style={{flex:2,padding:"14px",borderRadius:14,border:"none",background:"linear-gradient(135deg,var(--rose),var(--violet))",color:"#fff",fontWeight:600,fontSize:15,boxShadow:"0 8px 24px rgba(124,92,224,0.2)"}}>
                                            Confirm Booking ‚úì
                                        </button>
                                    </div>
                                </div>
                            )}

                            {/* Step 3: Success */}
                            {step === 3 && (
                                <div className="fade-up" style={{textAlign:"center",padding:"20px 0"}}>
                                    {/* Confetti */}
                                    <div style={{position:"relative",height:60,margin:"0 auto 8px",width:60}}>
                                        {['üéâ','‚ú®','üéä','üíú','‚≠ê'].map((e,i)=>(
                                            <span key={i} style={{position:"absolute",top:"50%",left:"50%",fontSize:20,animation:`confetti${(i%3)+1} 1s ease ${i*0.1}s forwards`}}>{e}</span>
                                        ))}
                                    </div>

                                    <div style={{width:64,height:64,borderRadius:"50%",background:"rgba(61,139,110,0.1)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"}}>
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none"><path d="M5 13l4 4L19 7" stroke="var(--sage)" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"/></svg>
                                    </div>
                                    <h3 style={{fontFamily:"var(--serif)",fontSize:26,marginBottom:8}}>Booking Confirmed!</h3>
                                    <p style={{color:"var(--stone)",fontSize:14,marginBottom:20}}>Reference: <strong>{bookingRef.current}</strong></p>

                                    <div style={{background:"var(--warm)",borderRadius:14,padding:16,marginBottom:24,textAlign:"left"}}>
                                        <div style={{fontSize:13,color:"var(--stone)",marginBottom:8}}>What happens next:</div>
                                        <div style={{fontSize:14,lineHeight:1.8}}>
                                            1. {vendor.name} will receive your request<br/>
                                            2. They'll confirm availability within 24h<br/>
                                            3. You'll coordinate final details via WhatsApp
                                        </div>
                                    </div>

                                    <div style={{display:"flex",gap:10}}>
                                        <a href={`https://wa.me/${vendor.contact.replace(/\s+/g,'').replace('+','')}?text=${encodeURIComponent(`Hola! Acabo de reservar por Prendy üéâ\n\nRef: ${bookingRef.current}\nPaquete: ${selectedPkg.name}\nFecha: ${bookingDate}\nHora: ${bookingTime}\n${selectedPkg.pricePerHead>0?`Invitados: ${guestCount}\n`:''}${bookingNotes?`Notas: ${bookingNotes}`:''}\n\nQuedo atento para confirmar!`)}`} target="_blank" rel="noopener" style={{flex:1,padding:"14px",borderRadius:14,border:"none",background:"#25D366",color:"#fff",fontWeight:600,fontSize:14,textDecoration:"none",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:6}}>
                                            üí¨ Message on WhatsApp
                                        </a>
                                        <button onClick={onClose} style={{flex:1,padding:"14px",borderRadius:14,border:"1.5px solid var(--border)",background:"transparent",fontWeight:600,fontSize:14}}>
                                            Done
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        /* =========================================
           VENDOR CARD (with Book button)
           ========================================= */
        const VendorCard = ({ vendor, onBook }) => (
            <div className="card" style={{display:"flex",gap:16,alignItems:"flex-start"}}>
                <div style={{fontSize:28,width:52,height:52,borderRadius:14,background:"var(--warm)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0}}>{vendor.img}</div>
                <div style={{flex:1,minWidth:0}}>
                    <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:8}}>
                        <div>
                            <div style={{fontWeight:600,fontSize:15}}>{vendor.name}</div>
                            <div style={{fontSize:13,color:"var(--stone)"}}>{vendor.specialty}</div>
                        </div>
                        <div className="pill" style={{background:"rgba(61,139,110,0.08)",color:"var(--sage)",flexShrink:0}}>‚òÖ {vendor.rating}</div>
                    </div>
                    <div style={{display:"flex",gap:6,marginTop:10,flexWrap:"wrap"}}>
                        <span className="pill" style={{background:"var(--warm)",color:"var(--stone)",fontSize:12}}>{vendor.area}</span>
                        <span className="pill" style={{background:"var(--warm)",color:"var(--stone)",fontSize:12}}>{vendor.priceRange}</span>
                        {vendor.packages && <span className="pill" style={{background:"rgba(124,92,224,0.06)",color:"var(--violet)",fontSize:12}}>{vendor.packages.length} packages</span>}
                    </div>
                    <div style={{display:"flex",gap:8,marginTop:12}}>
                        <button onClick={()=>onBook(vendor)} style={{padding:"10px 22px",borderRadius:100,border:"none",background:"var(--ink)",color:"#fff",fontSize:13,fontWeight:600}}>
                            Book Now ‚Üí
                        </button>
                        <a href={`https://wa.me/${vendor.contact.replace(/\s+/g,'').replace('+','')}`} target="_blank" rel="noopener" style={{padding:"10px 18px",borderRadius:100,border:"1.5px solid var(--border)",background:"transparent",fontSize:13,fontWeight:500,color:"var(--ink)",textDecoration:"none",display:"flex",alignItems:"center"}}>
                            üí¨ Chat
                        </a>
                    </div>
                </div>
            </div>
        );

        /* =========================================
           DONUT CHART
           ========================================= */
        const BudgetDonut=({budget,total})=>{const sz=180,st=22,r=(sz-st)/2,ci=2*Math.PI*r;const colors={venue:"#7c5ce0",food:"#d4536a",drinks:"#d4930a",entertainment:"#3d8b6e",staff:"#06b6d4",misc:"#8a8578"};const labels={venue:"Venue",food:"Food",drinks:"Drinks",entertainment:"Entertainment",staff:"Staff",misc:"Misc"};let offset=0;const segments=Object.entries(budget).map(([k,v])=>{const s={key:k,pct:v.pct,amount:v.amount,color:colors[k],label:labels[k],offset};offset+=ci*(v.pct/100);return s;});return(<div style={{display:"flex",alignItems:"center",gap:32,flexWrap:"wrap"}}><svg width={sz} height={sz} viewBox={`0 0 ${sz} ${sz}`} style={{flexShrink:0}}>{segments.map(s=><circle key={s.key} cx={sz/2} cy={sz/2} r={r} fill="none" stroke={s.color} strokeWidth={st} strokeDasharray={`${ci*(s.pct/100)} ${ci}`} strokeDashoffset={`-${s.offset}`} transform={`rotate(-90 ${sz/2} ${sz/2})`} strokeLinecap="round"/>)}<text x="50%" y="48%" textAnchor="middle" fill="var(--ink)" fontSize="18" fontWeight="700" fontFamily="var(--serif)">{fmtCLP(total)}</text><text x="50%" y="62%" textAnchor="middle" fill="var(--stone)" fontSize="11">CLP Total</text></svg><div style={{display:"flex",flexDirection:"column",gap:8}}>{segments.map(s=>(<div key={s.key} style={{display:"flex",alignItems:"center",gap:10,fontSize:14}}><div style={{width:10,height:10,borderRadius:3,background:s.color,flexShrink:0}}/><span style={{color:"var(--stone)",minWidth:90}}>{s.label}</span><span style={{fontWeight:600}}>{fmtCLP(s.amount)}</span><span style={{color:"var(--stone)",fontSize:12}}>({s.pct}%)</span></div>))}</div></div>);};

        /* =========================================
           SHOWCASE CAROUSEL
           ========================================= */
        const ShowcaseCarousel = () => {
            const scrollRef = useRef(null);
            const [active, setActive] = useState(null);
            const [currentSlide, setCurrentSlide] = useState(0);
            const [isHovered, setIsHovered] = useState(false);
            const [imgLoaded, setImgLoaded] = useState({});
            const autoSlideRef = useRef(null);

            const cardW = 340;
            const gap = 24;
            const cardWidth = cardW + gap;
            const totalSlides = SHOWCASE_EVENTS.length;

            const scrollToSlide = (index) => {
                const el = scrollRef.current;
                if (!el) return;
                const card = el.children[index];
                if (!card) return;
                const cardCenter = card.offsetLeft + card.offsetWidth / 2;
                const containerCenter = el.offsetWidth / 2;
                el.scrollTo({ left: cardCenter - containerCenter, behavior: 'smooth' });
                setCurrentSlide(index);
            };

            const scroll = (dir) => {
                const next = dir > 0
                    ? (currentSlide + 1) % totalSlides
                    : (currentSlide - 1 + totalSlides) % totalSlides;
                scrollToSlide(next);
            };

            // Auto-slide
            useEffect(() => {
                if (isHovered || active !== null) return;
                autoSlideRef.current = setInterval(() => {
                    setCurrentSlide(prev => {
                        const next = (prev + 1) % totalSlides;
                        const el = scrollRef.current;
                        if (el && el.children[next]) {
                            const card = el.children[next];
                            const cardCenter = card.offsetLeft + card.offsetWidth / 2;
                            const containerCenter = el.offsetWidth / 2;
                            el.scrollTo({ left: cardCenter - containerCenter, behavior: 'smooth' });
                        }
                        return next;
                    });
                }, 4000);
                return () => clearInterval(autoSlideRef.current);
            }, [isHovered, active]);

            // Track scroll position for dot indicators
            useEffect(() => {
                const el = scrollRef.current;
                if (!el) return;
                const handleScroll = () => {
                    const center = el.scrollLeft + el.offsetWidth / 2;
                    let closest = 0;
                    let minDist = Infinity;
                    Array.from(el.children).forEach((card, i) => {
                        const cardCenter = card.offsetLeft + card.offsetWidth / 2;
                        const dist = Math.abs(center - cardCenter);
                        if (dist < minDist) { minDist = dist; closest = i; }
                    });
                    setCurrentSlide(closest);
                };
                el.addEventListener('scroll', handleScroll, { passive: true });
                return () => el.removeEventListener('scroll', handleScroll);
            }, []);

            return (
                <div style={{maxWidth:"100vw",padding:"80px 0 60px"}}
                     onMouseEnter={()=>setIsHovered(true)}
                     onMouseLeave={()=>setIsHovered(false)}>
                    <div style={{maxWidth:900,margin:"0 auto",padding:"0 24px",marginBottom:32,display:"flex",justifyContent:"space-between",alignItems:"flex-end"}}>
                        <div>
                            <div className="pill" style={{background:"rgba(212,83,106,0.08)",color:"var(--rose)",marginBottom:12}}>‚ú¶ Showcase</div>
                            <h2 style={{fontFamily:"var(--serif)",fontSize:"clamp(28px,4vw,42px)",lineHeight:1.1}}>Events powered<br/>by <em style={{fontStyle:"italic"}}>Prendy</em></h2>
                        </div>
                        <div style={{display:"flex",gap:8}}>
                            <button onClick={()=>scroll(-1)} style={{width:44,height:44,borderRadius:14,border:"1.5px solid var(--border)",background:"var(--card)",fontSize:18,display:"flex",alignItems:"center",justifyContent:"center",transition:"all .2s"}}>‚Üê</button>
                            <button onClick={()=>scroll(1)} style={{width:44,height:44,borderRadius:14,border:"1.5px solid var(--border)",background:"var(--card)",fontSize:18,display:"flex",alignItems:"center",justifyContent:"center",transition:"all .2s"}}>‚Üí</button>
                        </div>
                    </div>

                    <div ref={scrollRef} className="carousel-track">
                        {SHOWCASE_EVENTS.map((evt,i)=>(
                            <div key={i} className="carousel-card" onClick={()=>setActive(active===i?null:i)}
                                 style={{color:"#fff",height:active===i?'auto':'420px',overflow:"hidden"}}>
                                {/* Photo background */}
                                <div style={{position:"absolute",inset:0,background:evt.gradient,transition:"opacity .5s ease"}}>
                                    <img
                                        src={evt.photo}
                                        alt={evt.title}
                                        onLoad={()=>setImgLoaded(p=>({...p,[i]:true}))}
                                        style={{
                                            width:"100%",height:"100%",objectFit:"cover",
                                            opacity:imgLoaded[i]?1:0,
                                            transition:"opacity .6s ease"
                                        }}
                                    />
                                </div>
                                {/* Dark overlay for readability */}
                                <div style={{position:"absolute",inset:0,background:"linear-gradient(to top, rgba(0,0,0,0.78) 0%, rgba(0,0,0,0.25) 40%, rgba(0,0,0,0.1) 100%)"}}/>

                                <div style={{position:"relative",zIndex:1,padding:28,height:"100%",display:"flex",flexDirection:"column"}}>
                                    <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"auto"}}>
                                        <div className="pill" style={{background:"rgba(255,255,255,0.18)",color:"#fff",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)"}}>{evt.type}</div>
                                        <div style={{fontSize:12,opacity:0.8,background:"rgba(0,0,0,0.3)",padding:"4px 10px",borderRadius:8,backdropFilter:"blur(6px)"}}>{evt.guests} guests</div>
                                    </div>

                                    <div style={{marginTop:60}}>
                                        <h3 style={{fontFamily:"var(--serif)",fontSize:28,marginBottom:6,lineHeight:1.2,textShadow:"0 2px 12px rgba(0,0,0,0.4)"}}>{evt.title}</h3>
                                        <div style={{fontSize:14,opacity:0.9,marginBottom:4,textShadow:"0 1px 6px rgba(0,0,0,0.3)"}}>{evt.subtitle}</div>
                                        <div style={{fontSize:12,opacity:0.75}}>üìç {evt.location}</div>
                                    </div>

                                    {/* Stats row */}
                                    <div style={{display:"flex",gap:16,marginTop:20,paddingTop:16,borderTop:"1px solid rgba(255,255,255,0.2)"}}>
                                        <div><div style={{fontSize:20,fontWeight:700,textShadow:"0 1px 4px rgba(0,0,0,0.3)"}}>{evt.stats.satisfaction}</div><div style={{fontSize:10,opacity:0.7}}>satisfaction</div></div>
                                        <div><div style={{fontSize:20,fontWeight:700,textShadow:"0 1px 4px rgba(0,0,0,0.3)"}}>{evt.stats.vendors}</div><div style={{fontSize:10,opacity:0.7}}>vendors</div></div>
                                        <div><div style={{fontSize:20,fontWeight:700,textShadow:"0 1px 4px rgba(0,0,0,0.3)"}}>{evt.stats.saved}</div><div style={{fontSize:10,opacity:0.7}}>hours saved</div></div>
                                    </div>

                                    {/* Expandable quote */}
                                    {active === i && (
                                        <div style={{marginTop:16,padding:"16px 18px",background:"rgba(255,255,255,0.12)",borderRadius:14,backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",animation:"fadeUp .3s ease"}}>
                                            <div style={{fontSize:14,lineHeight:1.5,fontStyle:"italic",opacity:0.95}}>"{evt.quote}"</div>
                                        </div>
                                    )}
                                </div>
                            </div>
                        ))}
                    </div>

                    {/* Slide indicator dots */}
                    <div style={{display:"flex",justifyContent:"center",gap:8,marginTop:24}}>
                        {SHOWCASE_EVENTS.map((_,i) => (
                            <button key={i} onClick={()=>scrollToSlide(i)}
                                style={{
                                    width: currentSlide === i ? 28 : 8,
                                    height: 8,
                                    borderRadius: 4,
                                    border: "none",
                                    background: currentSlide === i ? "var(--rose)" : "var(--border)",
                                    transition: "all .3s ease",
                                    cursor: "pointer",
                                    padding: 0
                                }}
                            />
                        ))}
                    </div>

                    {/* Social proof numbers */}
                    <div style={{maxWidth:900,margin:"40px auto 0",padding:"0 24px",display:"flex",justifyContent:"center",gap:48,flexWrap:"wrap"}}>
                        {[{n:"2,400+",l:"guests served"},{n:"180+",l:"events planned"},{n:"$850M+",l:"CLP managed"},{n:"4.9/5",l:"avg satisfaction"}].map(s=>(
                            <div key={s.l} style={{textAlign:"center"}}>
                                <div style={{fontFamily:"var(--serif)",fontSize:28}}>{s.n}</div>
                                <div style={{fontSize:12,color:"var(--stone)"}}>{s.l}</div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        /* =========================================
           SHOP TAB (same as v2)
           ========================================= */
        const ShopTab = ({ supplies, blueprintText }) => {
            const [items, setItems] = useState(() => buildShoppingList(supplies, blueprintText));
            const [filterStore, setFilterStore] = useState('all');
            const [toast, setToast] = useState(null);

            useEffect(() => {
                setItems(buildShoppingList(supplies, blueprintText));
            }, [supplies, blueprintText]);
            const toggleCheck=(id)=>setItems(p=>p.map(i=>i.id===id?{...i,checked:!i.checked}:i));
            const checkAll=(store)=>setItems(p=>p.map(i=>i.store===store?{...i,checked:true}:i));
            const uncheckAll=()=>setItems(p=>p.map(i=>({...i,checked:false})));
            const showToast=(msg)=>{setToast(msg);setTimeout(()=>setToast(null),2500);};
            const grouped=useMemo(()=>{const g={};const f=filterStore==='all'?items:items.filter(i=>i.store===filterStore);f.forEach(i=>{if(!g[i.store])g[i.store]=[];g[i.store].push(i);});return g;},[items,filterStore]);
            const totalEstimate=items.reduce((s,i)=>s+i.estimatedPrice,0);
            const checkedEstimate=items.filter(i=>i.checked).reduce((s,i)=>s+i.estimatedPrice,0);
            const checkedCount=items.filter(i=>i.checked).length;
            const storeOrder=['lider','jumbo','cornershop','rappi','ubereats'];
            const copyList=(sk)=>{const si=sk==='all'?items:items.filter(i=>i.store===sk);const t=si.map(i=>`${i.checked?'‚úÖ':'‚¨ú'} ${i.name} ‚Äî ${i.quantity} ${i.unit} (~${fmtCLP(i.estimatedPrice)})`).join('\n');navigator.clipboard.writeText(`üõí ${sk==='all'?'Prendy Shopping List':PLATFORMS[sk].name+' List'}\n\n${t}\n\nTotal: ~${fmtCLP(sk==='all'?totalEstimate:si.reduce((s,i)=>s+i.estimatedPrice,0))}`);showToast("‚úì Copied to clipboard!");};
            const shareWhatsApp=()=>{const t=items.map(i=>`${i.checked?'‚úÖ':'‚¨ú'} ${i.name} ‚Äî ${i.quantity} ${i.unit}`).join('\n');window.open(`https://wa.me/?text=${encodeURIComponent(`üõí *Prendy Shopping List*\n\n${t}\n\nüí∞ Total: ~${fmtCLP(totalEstimate)}`)}`, '_blank');};

            return (
                <div className="fade-up">
                    <div className="card" style={{marginBottom:20,background:"linear-gradient(135deg,rgba(124,92,224,0.04),rgba(212,83,106,0.04))"}}>
                        <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:16}}>
                            <div><div style={{fontSize:13,color:"var(--stone)",fontWeight:500,marginBottom:4}}>Estimated Grocery Total</div><div style={{fontFamily:"var(--serif)",fontSize:36}}>{fmtCLP(totalEstimate)}</div></div>
                            <div style={{textAlign:"right"}}><div style={{fontSize:28,fontWeight:700,color:"var(--sage)"}}>{checkedCount}/{items.length}</div><div style={{fontSize:12,color:"var(--stone)"}}>items checked</div></div>
                        </div>
                        {checkedCount>0&&(<div style={{marginTop:16,padding:"12px 16px",background:"rgba(61,139,110,0.06)",borderRadius:12,display:"flex",justifyContent:"space-between",alignItems:"center"}}><span style={{fontSize:14,color:"var(--sage)",fontWeight:500}}>‚úì Checked: {fmtCLP(checkedEstimate)}</span><button onClick={uncheckAll} style={{fontSize:12,padding:"4px 12px",borderRadius:100,border:"1px solid rgba(61,139,110,0.2)",background:"transparent",color:"var(--sage)",fontWeight:600}}>Clear all</button></div>)}
                    </div>
                    <div style={{display:"flex",gap:10,marginBottom:20,flexWrap:"wrap"}}>
                        <button onClick={()=>copyList('all')} style={{padding:"10px 20px",borderRadius:100,border:"1.5px solid var(--border)",background:"var(--card)",fontWeight:600,fontSize:13,display:"flex",alignItems:"center",gap:6}}>üìã Copy Full List</button>
                        <button onClick={shareWhatsApp} style={{padding:"10px 20px",borderRadius:100,border:"none",background:"#25D366",color:"#fff",fontWeight:600,fontSize:13,display:"flex",alignItems:"center",gap:6}}>üí¨ Share via WhatsApp</button>
                    </div>
                    <div style={{display:"flex",gap:6,marginBottom:24,overflowX:"auto",paddingBottom:4}}>
                        <Chip selected={filterStore==='all'} onClick={()=>setFilterStore('all')}>All Stores</Chip>
                        {storeOrder.filter(s=>items.some(i=>i.store===s)).map(s=>(<Chip key={s} selected={filterStore===s} onClick={()=>setFilterStore(s)}>{PLATFORMS[s].icon} {PLATFORMS[s].name}</Chip>))}
                    </div>
                    {storeOrder.filter(s=>grouped[s]).map(sk=>{const p=PLATFORMS[sk];const si=grouped[sk];const st2=si.reduce((s,i)=>s+i.estimatedPrice,0);const ac=si.every(i=>i.checked);return(
                        <div key={sk} className="card" style={{marginBottom:16}}>
                            <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}}>
                                <div style={{display:"flex",alignItems:"center",gap:12}}><div style={{width:44,height:44,borderRadius:12,background:p.bgLight,display:"flex",alignItems:"center",justifyContent:"center",fontSize:22}}>{p.icon}</div><div><div style={{fontWeight:700,fontSize:16}}>{p.name}</div><div style={{fontSize:12,color:"var(--stone)"}}>{p.delivery} ¬∑ {si.length} items</div></div></div>
                                <div style={{textAlign:"right"}}><div style={{fontWeight:700,fontSize:16}}>~{fmtCLP(st2)}</div><div style={{fontSize:11,color:"var(--stone)"}}>estimated</div></div>
                            </div>
                            {si.map(item=>(
                                <div key={item.id} className="checkbox-row" style={{ opacity: item.checked ? 0.5 : 1 }}>
                                    <div className={`custom-check ${item.checked?'checked':''}`} onClick={()=>toggleCheck(item.id)}>{item.checked&&<svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M3 7L6 10L11 4" stroke="#fff" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/></svg>}</div>
                                    <div style={{flex:1,minWidth:0}}><div style={{fontWeight:500,fontSize:14,textDecoration:item.checked?"line-through":"none"}}>{item.name}</div>{item.note&&<div style={{fontSize:12,color:"var(--stone)",marginTop:1}}>{item.note}</div>}</div>
                                    <div style={{textAlign:"right",flexShrink:0}}><div style={{fontWeight:600,fontSize:14}}>{item.quantity} {item.unit}</div><div style={{fontSize:12,color:"var(--stone)"}}>~{fmtCLP(item.estimatedPrice)}</div></div>
                                </div>
                            ))}
                            <div style={{display:"flex",gap:8,marginTop:16,flexWrap:"wrap"}}>
                                <button onClick={()=>window.open(p.searchUrl(si[0]?.searchTerm||''),'_blank')} style={{flex:1,padding:"12px 20px",borderRadius:14,border:"none",background:p.color,color:"#fff",fontWeight:600,fontSize:14,minWidth:160}}>Open {p.name} ‚Üí</button>
                                <button onClick={()=>copyList(sk)} style={{padding:"12px 20px",borderRadius:14,border:"1.5px solid var(--border)",background:"var(--card)",fontWeight:500,fontSize:14}}>üìã Copy</button>
                                {!ac&&<button onClick={()=>checkAll(sk)} style={{padding:"12px 20px",borderRadius:14,border:"1.5px solid var(--border)",background:"var(--card)",fontWeight:500,fontSize:14}}>‚úì Check all</button>}
                            </div>
                        </div>
                    );})}
                    <div className="card" style={{marginTop:8,background:"var(--warm)",border:"none"}}><h4 style={{fontSize:14,fontWeight:600,marginBottom:12,color:"var(--stone)"}}>üí° Ordering Tips</h4><div style={{fontSize:13,lineHeight:1.7,color:"var(--stone)"}}><strong style={{color:"var(--ink)"}}>Lider.cl</strong> ‚Äî Best prices for bulk. Order 2-3 days ahead.<br/><strong style={{color:"var(--ink)"}}>Jumbo</strong> ‚Äî Premium selection, better deli & imported goods.<br/><strong style={{color:"var(--ink)"}}>Cornershop</strong> ‚Äî Shops multiple stores in one order.<br/><strong style={{color:"var(--ink)"}}>Rappi</strong> ‚Äî Fastest for drinks, ice & last-minute items.<br/><strong style={{color:"var(--ink)"}}>Uber Eats</strong> ‚Äî Skip cooking: order catering trays directly.</div></div>
                    <Toast message={toast} visible={!!toast}/>
                </div>
            );
        };

        /* =========================================
           VIEWS
           ========================================= */
        const Landing = ({ onStart }) => (
            <div>
                {/* Hero */}
                <div className="fade-up" style={{textAlign:"center",padding:"100px 24px 40px",maxWidth:720,margin:"0 auto"}}>
                    <div className="pill fade-up" style={{background:"rgba(124,92,224,0.08)",color:"var(--violet)",marginBottom:24}}>
                        <span style={{width:6,height:6,borderRadius:"50%",background:"var(--sage)",display:"inline-block"}}/> v0.3 ‚Äî Santiago
                    </div>
                    <h1 className="fade-up-d1" style={{fontFamily:"var(--serif)",fontSize:"clamp(42px,7vw,72px)",fontWeight:400,lineHeight:1.05,marginBottom:24,letterSpacing:"-.02em"}}>
                        The OS<br/>that makes social life <em style={{fontStyle:"italic",color:"var(--rose)"}}>Effortless</em>
                    </h1>
                    <p className="fade-up-d2" style={{fontSize:19,color:"var(--stone)",maxWidth:540,margin:"0 auto 48px",lineHeight:1.6}}>
                        <span style={{fontWeight:700,color:"var(--ink)",fontSize:20}}>Events shouldn't require planning. Just the decision to bring people together.</span>
                        <br/><br/>
                        Decide to host. Prendy takes it from there ‚Äî coordinating vendors, sourcing supplies, and structuring the logistics behind the scenes.

Everything in one place. Just a few clicks. No stress.
                    </p>
                    <button className="fade-up-d3" onClick={onStart} style={{padding:"18px 52px",borderRadius:100,border:"none",background:"var(--ink)",color:"#fff",fontSize:17,fontWeight:600,boxShadow:"0 12px 40px rgba(15,15,15,0.12)"}}>Create Your Blueprint ‚Üí</button>

                    <div className="fade-up-d4" style={{marginTop:60,display:"flex",justifyContent:"center",gap:40,flexWrap:"wrap"}}>
                        {[{n:"30s",l:"avg. blueprint time"},{n:"5",l:"delivery platforms"},{n:"24+",l:"bookable vendors"}].map(s=>(
                            <div key={s.l}><div style={{fontFamily:"var(--serif)",fontSize:32}}>{s.n}</div><div style={{fontSize:13,color:"var(--stone)"}}>{s.l}</div></div>
                        ))}
                    </div>
                    <div className="fade-up-d4" style={{marginTop:40,display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"}}>
                        {Object.values(PLATFORMS).map(p=>(<div key={p.name} style={{display:"flex",alignItems:"center",gap:6,padding:"8px 14px",borderRadius:12,background:"var(--warm)",fontSize:12,fontWeight:600,color:"var(--stone)"}}><span style={{fontSize:16}}>{p.icon}</span>{p.name}</div>))}
                    </div>
                </div>

                {/* Showcase Carousel */}
                <ShowcaseCarousel />

                {/* How It Works */}
                <div style={{maxWidth:960,margin:"0 auto",padding:"100px 24px 80px"}}>
                    <div style={{textAlign:"center",marginBottom:56}}>
                        <div className="pill" style={{background:"rgba(61,139,110,0.08)",color:"var(--sage)",marginBottom:12,display:"inline-flex"}}>How It Works</div>
                        <h2 style={{fontFamily:"var(--serif)",fontSize:"clamp(28px,4vw,42px)",lineHeight:1.1}}>Four steps to your<br/><em style={{fontStyle:"italic",color:"var(--rose)"}}>perfect gathering</em></h2>
                    </div>

                    {/* Doodle-style roadmap */}
                    {(() => {
                        const steps = [
                            {step:"01",title:"Describe your event",desc:"Tell us the type, guest count, budget, and vibe. Our AI understands what makes your gathering unique.",icon:"‚úçÔ∏è",color:"var(--violet)",bg:"rgba(124,92,224,0.06)"},
                            {step:"02",title:"Get your Blueprint",desc:"In 30 seconds, receive a complete logistics plan ‚Äî timeline, vendors, supplies, staffing, and budget breakdown.",icon:"üìã",color:"var(--rose)",bg:"rgba(212,83,106,0.06)"},
                            {step:"03",title:"Book vendors",desc:"Browse 24+ Santiago vendors with ratings and packages. Book directly via WhatsApp ‚Äî no phone tag needed.",icon:"üìÖ",color:"var(--sage)",bg:"rgba(61,139,110,0.06)"},
                            {step:"04",title:"Order & Share",desc:"Send grocery lists to 5 delivery platforms, compare prices, and share everything with your crew via WhatsApp.",icon:"üöÄ",color:"var(--amber)",bg:"rgba(212,147,10,0.06)"}
                        ];

                        return (
                            <div style={{position:"relative",maxWidth:800,margin:"0 auto"}}>
                                {steps.map((s,i) => {
                                    const isEven = i % 2 === 0;
                                    return (
                                        <div key={s.step}>
                                            {/* Step card row */}
                                            <div style={{
                                                display:"flex",
                                                alignItems:"center",
                                                gap:0,
                                                flexDirection: isEven ? "row" : "row-reverse",
                                                position:"relative",
                                                zIndex:2
                                            }}>
                                                {/* Step card */}
                                                <div className="card" style={{
                                                    flex:"0 0 auto",
                                                    width:"min(380px, 70%)",
                                                    position:"relative",
                                                    overflow:"visible",
                                                    border:`2px solid ${s.color}22`,
                                                    background:`linear-gradient(135deg, ${s.bg}, var(--card))`,
                                                    borderRadius:24,
                                                    padding:"28px 28px 24px",
                                                    transition:"transform .2s,box-shadow .2s"
                                                }}>
                                                    <div style={{
                                                        fontSize:48,fontFamily:"var(--serif)",fontWeight:400,
                                                        color:s.color,opacity:0.15,
                                                        position:"absolute",top:12,right:20,lineHeight:1
                                                    }}>{s.step}</div>
                                                    <div style={{fontSize:36,marginBottom:12}}>{s.icon}</div>
                                                    <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:8,color:"var(--ink)"}}>{s.title}</h3>
                                                    <p style={{fontSize:15,lineHeight:1.6,color:"var(--stone)"}}>{s.desc}</p>
                                                </div>

                                                {/* Doodle step number circle */}
                                                <div style={{
                                                    flex:"0 0 auto",
                                                    width:52,height:52,
                                                    borderRadius:"50%",
                                                    background:s.color,
                                                    color:"#fff",
                                                    display:"flex",alignItems:"center",justifyContent:"center",
                                                    fontFamily:"var(--serif)",fontSize:20,fontWeight:700,
                                                    boxShadow:`0 4px 20px ${s.color}44`,
                                                    border:"3px solid var(--paper)",
                                                    position:"relative",
                                                    zIndex:5,
                                                    marginLeft: isEven ? -16 : 0,
                                                    marginRight: isEven ? 0 : -16
                                                }}>
                                                    {i+1}
                                                </div>
                                            </div>

                                            {/* Doodle connector between steps */}
                                            {i < steps.length - 1 && (
                                                <div style={{
                                                    display:"flex",
                                                    justifyContent:"center",
                                                    position:"relative",
                                                    zIndex:1,
                                                    margin:"-4px 0",
                                                    height:60
                                                }}>
                                                    <svg width="200" height="60" viewBox="0 0 200 60" fill="none" style={{overflow:"visible"}}>
                                                        {isEven ? (
                                                            <path
                                                                d={`M 60 0 C 60 20, 140 20, 140 60`}
                                                                stroke={steps[i+1].color}
                                                                strokeWidth="2.5"
                                                                strokeDasharray="8 6"
                                                                strokeLinecap="round"
                                                                fill="none"
                                                                opacity="0.4"
                                                            />
                                                        ) : (
                                                            <path
                                                                d={`M 140 0 C 140 20, 60 20, 60 60`}
                                                                stroke={steps[i+1].color}
                                                                strokeWidth="2.5"
                                                                strokeDasharray="8 6"
                                                                strokeLinecap="round"
                                                                fill="none"
                                                                opacity="0.4"
                                                            />
                                                        )}
                                                        {/* Small decorative dots along path */}
                                                        <circle cx={isEven ? "90" : "110"} cy="20" r="3" fill={steps[i+1].color} opacity="0.25"/>
                                                        <circle cx="100" cy="40" r="2" fill={steps[i+1].color} opacity="0.2"/>
                                                    </svg>
                                                </div>
                                            )}
                                        </div>
                                    );
                                })}

                                {/* Vertical doodle spine line (behind everything) */}
                                <svg style={{
                                    position:"absolute",
                                    top:40,
                                    left:"50%",
                                    transform:"translateX(-50%)",
                                    width:4,
                                    height:"calc(100% - 80px)",
                                    zIndex:0,
                                    overflow:"visible"
                                }}>
                                    <line x1="2" y1="0" x2="2" y2="100%" stroke="var(--border)" strokeWidth="2" strokeDasharray="6 8" strokeLinecap="round" opacity="0.5"/>
                                </svg>
                            </div>
                        );
                    })()}

                    {/* Mobile-friendly fallback: show as simple vertical roadmap */}
                    <style dangerouslySetInnerHTML={{__html:`
                        @media(max-width:640px) {
                            .card { max-width:100%!important; }
                        }
                    `}}/>
                </div>

                {/* Platform Integration */}
                <div style={{background:"var(--warm)",borderTop:"1px solid var(--border)",borderBottom:"1px solid var(--border)",padding:"80px 24px"}}>
                    <div style={{maxWidth:960,margin:"0 auto"}}>
                        <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:60,alignItems:"center"}} className="grid-2">
                            <div>
                                <div className="pill" style={{background:"rgba(212,147,10,0.08)",color:"var(--amber)",marginBottom:12}}>Integrations</div>
                                <h2 style={{fontFamily:"var(--serif)",fontSize:"clamp(26px,3.5vw,38px)",lineHeight:1.1,marginBottom:20}}>Connected to<br/>every platform <em style={{fontStyle:"italic",color:"var(--rose)"}}>you need</em></h2>
                                <p style={{fontSize:16,lineHeight:1.7,color:"var(--stone)",marginBottom:28}}>
                                    One-tap grocery ordering across Chile's top delivery apps. Compare prices, split lists by store, and share via WhatsApp ‚Äî all from your Blueprint.
                                </p>
                                <div style={{display:"flex",gap:12,flexWrap:"wrap"}}>
                                    {Object.values(PLATFORMS).map(p=>(
                                        <div key={p.name} style={{display:"flex",alignItems:"center",gap:8,padding:"12px 18px",borderRadius:14,background:"var(--card)",border:"1px solid var(--border)",fontSize:14,fontWeight:600,color:"var(--ink)"}}>
                                            <span style={{fontSize:20}}>{p.icon}</span>{p.name}
                                        </div>
                                    ))}
                                </div>
                            </div>
                            <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16}}>
                                {[
                                    {n:"5",l:"delivery platforms",color:"var(--violet)"},
                                    {n:"30s",l:"avg. blueprint time",color:"var(--rose)"},
                                    {n:"24+",l:"bookable vendors",color:"var(--sage)"},
                                    {n:"1-tap",l:"grocery ordering",color:"var(--amber)"}
                                ].map(s=>(
                                    <div key={s.l} className="card" style={{textAlign:"center",padding:24,border:"1px solid var(--border)"}}>
                                        <div style={{fontFamily:"var(--serif)",fontSize:32,color:s.color}}>{s.n}</div>
                                        <div style={{fontSize:12,color:"var(--stone)",marginTop:4}}>{s.l}</div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>

                {/* Features Grid */}
                <div style={{maxWidth:960,margin:"0 auto",padding:"100px 24px 80px"}}>
                    <div style={{textAlign:"center",marginBottom:56}}>
                        <div className="pill" style={{background:"rgba(124,92,224,0.08)",color:"var(--violet)",marginBottom:12,display:"inline-flex"}}>Features</div>
                        <h2 style={{fontFamily:"var(--serif)",fontSize:"clamp(28px,4vw,42px)",lineHeight:1.1}}>Everything you need,<br/><em style={{fontStyle:"italic",color:"var(--violet)"}}>nothing you don't</em></h2>
                    </div>
                    <div style={{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(280px,1fr))",gap:20}}>
                        {[
                            {icon:"ü§ñ",title:"AI-Powered Blueprints",desc:"Our proprietary engine generates logistics plans tailored to your event type, budget, and vibe ‚Äî making everything easy and quick, fed by carefully curated human insights and continually improved by real outcomes and experiences."},
                            {icon:"üìÖ",title:"Vendor Booking",desc:"Browse 24+ Santiago vendors with ratings, packages, and instant WhatsApp booking. No phone tag needed."},
                            {icon:"üõí",title:"Smart Shopping Lists",desc:"Auto-generated grocery lists split by store, with price estimates and one-click ordering via delivery apps."},
                            {icon:"‚è∞",title:"Day-of Timeline",desc:"Hour-by-hour event schedule with task assignments, so everyone knows what to do and when."},
                            {icon:"üí∞",title:"Budget Breakdown",desc:"Visual budget allocation across venue, food, drinks, entertainment, and staff ‚Äî with real vendor pricing."},
                            {icon:"üí¨",title:"WhatsApp Integration",desc:"Share shopping lists, vendor confirmations, and event details directly through WhatsApp group chats."}
                        ].map(f=>(
                            <div key={f.title} className="card" style={{border:"1px solid var(--border)"}}>
                                <div style={{fontSize:32,marginBottom:12}}>{f.icon}</div>
                                <h3 style={{fontSize:17,fontWeight:700,marginBottom:8,color:"var(--ink)"}}>{f.title}</h3>
                                <p style={{fontSize:14,lineHeight:1.6,color:"var(--stone)"}}>{f.desc}</p>
                            </div>
                        ))}
                    </div>
                </div>

                {/* Testimonials */}
                <div style={{background:"var(--ink)",color:"#fff",padding:"100px 24px",position:"relative",overflow:"hidden"}}>
                    <div style={{position:"absolute",top:"-50%",right:"-20%",width:"60%",height:"200%",background:"radial-gradient(ellipse,rgba(124,92,224,0.08),transparent 70%)",pointerEvents:"none"}}/>
                    <div style={{maxWidth:960,margin:"0 auto",position:"relative"}}>
                        <div style={{textAlign:"center",marginBottom:56}}>
                            <div className="pill" style={{background:"rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.7)",marginBottom:12,display:"inline-flex"}}>Testimonials</div>
                            <h2 style={{fontFamily:"var(--serif)",fontSize:"clamp(28px,4vw,42px)",lineHeight:1.1}}>Loved by hosts<br/><em style={{fontStyle:"italic",color:"var(--rose)"}}>across Santiago</em></h2>
                        </div>
                        <div style={{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(280px,1fr))",gap:24}}>
                            {[
                                {name:"Camila R.",role:"Birthday party host",quote:"I planned my best friend's 30th in one evening. The shopping list alone saved me 3 hours of work.",stars:5},
                                {name:"Diego M.",role:"Corporate event planner",quote:"We use Prendy for all our team offsites now. The vendor matching is scary accurate ‚Äî it knows our vibe.",stars:5},
                                {name:"Valentina L.",role:"Dinner party enthusiast",quote:"The Vonnegut quote on the homepage sold me. Then the product delivered. My dinner parties have leveled up.",stars:5}
                            ].map(t=>(
                                <div key={t.name} style={{padding:28,background:"rgba(255,255,255,0.04)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:20}}>
                                    <div style={{fontSize:14,marginBottom:16}}>{"‚òÖ".repeat(t.stars)}</div>
                                    <p style={{fontSize:15,lineHeight:1.7,fontStyle:"italic",opacity:0.85,marginBottom:20}}>"{t.quote}"</p>
                                    <div>
                                        <div style={{fontWeight:700,fontSize:15}}>{t.name}</div>
                                        <div style={{fontSize:13,opacity:0.5}}>{t.role}</div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>

                {/* Why Prendy */}
                <div style={{maxWidth:960,margin:"0 auto",padding:"100px 24px 80px"}}>
                    <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:60,alignItems:"center"}} className="grid-2">
                        <div>
                            <div className="pill" style={{background:"rgba(212,83,106,0.08)",color:"var(--rose)",marginBottom:12}}>Why Prendy</div>
                            <h2 style={{fontFamily:"var(--serif)",fontSize:"clamp(26px,3.5vw,38px)",lineHeight:1.1,marginBottom:20}}>Built for the gatherings<br/><em style={{fontStyle:"italic",color:"var(--violet)"}}>that matter most</em></h2>
                            <p style={{fontSize:16,lineHeight:1.7,color:"var(--stone)",marginBottom:28}}>
                                Most event tools are built for professionals with big budgets. Prendy is built for everyone ‚Äî the Tuesday birthday, the spontaneous dinner, the celebration that almost didn't happen.
                            </p>
                        </div>
                        <div style={{display:"flex",flexDirection:"column",gap:16}}>
                            {[
                                {title:"No sign-up required",desc:"Generate your first Blueprint without creating an account."},
                                {title:"Santiago-native vendors",desc:"Every vendor is vetted and based in Santiago, Chile."},
                                {title:"Real-time pricing",desc:"Budget estimates based on actual vendor packages and store prices."},
                                {title:"WhatsApp-first workflow",desc:"Share and coordinate everything through the app your group already uses."}
                            ].map((item,i)=>(
                                <div key={i} style={{display:"flex",gap:16,alignItems:"flex-start"}}>
                                    <div style={{width:32,height:32,borderRadius:10,background:"linear-gradient(135deg,var(--violet),var(--rose))",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,color:"#fff",fontSize:14,fontWeight:700}}>{i+1}</div>
                                    <div>
                                        <div style={{fontWeight:700,fontSize:15,marginBottom:4}}>{item.title}</div>
                                        <div style={{fontSize:14,color:"var(--stone)",lineHeight:1.5}}>{item.desc}</div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>

                {/* ====== ABOUT ‚Äî The Envelope Philosophy ====== */}
                <div className="about-section" style={{padding:"80px 24px",background:"var(--ink)",color:"#fff",position:"relative",overflow:"hidden"}}>
                    {/* Decorative elements */}
                    <div style={{position:"absolute",top:60,left:"5%",width:300,height:300,borderRadius:"50%",background:"radial-gradient(circle,rgba(124,92,224,0.08) 0%,transparent 70%)",pointerEvents:"none"}}/>
                    <div style={{position:"absolute",bottom:40,right:"5%",width:400,height:400,borderRadius:"50%",background:"radial-gradient(circle,rgba(212,83,106,0.06) 0%,transparent 70%)",pointerEvents:"none"}}/>

                    <div style={{maxWidth:800,margin:"0 auto",position:"relative",zIndex:1}}>
                        {/* Section 1: The Poetic Hook */}
                        <div style={{marginBottom:64}}>
                            <div className="pill" style={{background:"rgba(255,255,255,0.08)",color:"rgba(255,255,255,0.7)",marginBottom:32,display:"inline-flex"}}>
                                <Icon name="heart" size={14} color="rgba(255,255,255,0.7)"/> Our Philosophy
                            </div>

                            {/* The Envelope Story ‚Äî Full Vonnegut */}
                            <div style={{display:"grid",gridTemplateColumns:"1fr",gap:32,maxWidth:720}}>
                                <div>
                                    <h3 style={{fontFamily:"var(--serif)",fontSize:"clamp(28px,4vw,40px)",marginBottom:24,color:"#fff",lineHeight:1.15}}>The Envelope Philosophy</h3>
                                    <p style={{fontSize:16,lineHeight:1.9,color:"rgba(255,255,255,0.7)",marginBottom:24}}>
                                        Kurt Vonnegut once shared a story about the simple act of buying an envelope:
                                    </p>
                                </div>

                                {/* The highlighted story */}
                                <div style={{position:"relative",padding:"40px 32px",borderRadius:24,background:"linear-gradient(135deg,rgba(124,92,224,0.08),rgba(212,83,106,0.06))",border:"1px solid rgba(255,255,255,0.06)"}}>
                                    <div style={{fontFamily:"var(--serif)",fontSize:100,lineHeight:1,color:"rgba(124,92,224,0.12)",position:"absolute",top:8,left:16,userSelect:"none"}}>"</div>
                                    <div style={{position:"relative",zIndex:1}}>
                                        <p style={{fontSize:16,lineHeight:1.9,color:"rgba(255,255,255,0.75)",marginBottom:20,fontStyle:"italic",fontFamily:"var(--serif)"}}>
                                            I once told my wife I was going out to buy an envelope.
                                        </p>
                                        <p style={{fontSize:16,lineHeight:1.9,color:"rgba(255,255,255,0.75)",marginBottom:20,fontStyle:"italic",fontFamily:"var(--serif)"}}>
                                            "Oh," she said, "well, you're not a poor man. You know, why don't you go online and buy a hundred envelopes and put them in the closet?" And so I pretended not to hear her. And went out to get an envelope because <em style={{color:"var(--violet)",fontStyle:"italic"}}>I have a hell of a good time in the process of buying one envelope.</em>
                                        </p>
                                        <p style={{fontSize:16,lineHeight:1.9,color:"rgba(255,255,255,0.75)",marginBottom:20,fontStyle:"italic",fontFamily:"var(--serif)"}}>
                                            I meet a lot of people. And see some great looking babies. And a fire engine goes by. And I give them the thumbs up. And I'll ask a woman what kind of dog that is. And, and I don't know.
                                        </p>
                                        <p style={{fontSize:"clamp(18px,2.5vw,22px)",lineHeight:1.6,color:"#fff",fontFamily:"var(--serif)",fontWeight:400,padding:"16px 0 0",borderTop:"1px solid rgba(255,255,255,0.08)"}}>
                                            <em>The moral of the story is ‚Äî</em> <br/><span style={{color:"var(--violet)"}}>we're here on Earth to fart around.</span>
                                        </p>
                                        <p style={{fontSize:16,lineHeight:1.9,color:"rgba(255,255,255,0.75)",marginTop:20,fontStyle:"italic",fontFamily:"var(--serif)"}}>
                                            Of course, the computers will do us out of that. But what the computer people don't realise, or they don't care, is <em style={{color:"var(--rose)",fontStyle:"italic"}}>we're dancing animals</em>. You know, we love to move around. And it's like we're not supposed to dance at all anymore.
                                        </p>
                                        <p style={{fontSize:16,lineHeight:1.9,color:"#fff",fontStyle:"italic",fontFamily:"var(--serif)",fontWeight:500,marginTop:20}}>
                                            Let's all get up and move around a bit right now‚Ä¶ or at least dance.
                                        </p>
                                    </div>
                                    <div style={{marginTop:16,textAlign:"right",fontSize:14,color:"rgba(255,255,255,0.4)",fontWeight:500}}>
                                        ‚Äî Kurt Vonnegut
                                    </div>
                                </div>

                                <div>
                                    <p style={{fontSize:16,lineHeight:1.9,color:"rgba(255,255,255,0.7)",marginBottom:16}}>
                                        That simple walk to buy an envelope ‚Äî the small talk, the babies, the fire engines ‚Äî Vonnegut called it <em style={{color:"var(--violet)",fontStyle:"italic"}}>"soul growing"</em> And it mattered.
                                    </p>
                                    <p style={{fontSize:16,lineHeight:1.9,color:"rgba(255,255,255,0.7)",marginBottom:16}}>
                                        We've optimized the "envelopes" out of our lives. We've traded the messy, beautiful friction of the real world for the frictionless isolation of a screen. We are more "efficient" than ever, and more alone than ever.
                                    </p>
                                    <p style={{fontSize:16,lineHeight:1.9,color:"rgba(255,255,255,0.7)"}}>
                                        Prendy does not intend to fight the new frictionless technology way of doing things, but to use it in the favour of reactivating social life and creating true social impact by doing so.
                                    </p>
                                </div>
                            </div>
                        </div>

                        {/* Divider */}
                        <div style={{height:1,background:"linear-gradient(90deg,transparent,rgba(255,255,255,0.1),transparent)",margin:"0 0 64px"}}/>

                        {/* Section 2: The Radical Mission */}
                        <div>
                            <div style={{display:"flex",alignItems:"center",gap:12,marginBottom:32}}>
                                <div style={{width:48,height:48,borderRadius:14,background:"rgba(212,83,106,0.12)",display:"flex",alignItems:"center",justifyContent:"center"}}>
                                    <Icon name="rocket" size={24} color="var(--rose)"/>
                                </div>
                                <h3 style={{fontFamily:"var(--serif)",fontSize:28,color:"#fff"}}>The Radical Mission</h3>
                            </div>

                            <div style={{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(280px,1fr))",gap:32,marginBottom:40}}>
                                <div>
                                    <h4 style={{fontSize:16,fontWeight:700,color:"var(--rose)",marginBottom:12,textTransform:"uppercase",letterSpacing:1}}>The Logistics of Isolation</h4>
                                    <p style={{fontSize:15,lineHeight:1.8,color:"rgba(255,255,255,0.7)"}}>
                                        Today, technology has made staying home effortless, while bringing people together remains a 10-hour administrative burden. We call this the <strong style={{color:"#fff"}}>"Logistical Tax"</strong> on social life. Between venue matching, vendor coordination, and guest payments, the "initiator" is burnt out before the party even begins.
                                    </p>
                                </div>
                                <div>
                                    <h4 style={{fontSize:16,fontWeight:700,color:"var(--violet)",marginBottom:12,textTransform:"uppercase",letterSpacing:1}}>The Social Renaissance</h4>
                                    <p style={{fontSize:15,lineHeight:1.8,color:"rgba(255,255,255,0.7)"}}>
                                        We don't just "plan events." We use <strong style={{color:"#fff"}}>Success Blueprints</strong> ‚Äî repeatable social formulas ‚Äî to codify the magic of a great host. Our proprietary engine makes everything easy and quick with AI, but it's fed by carefully curated human insights and continually improved by real outcomes and experiences.
                                    </p>
                                </div>
                            </div>

                            {/* Mission statement highlight */}
                            <div style={{
                                background:"linear-gradient(135deg,rgba(124,92,224,0.1),rgba(212,83,106,0.1))",
                                borderRadius:24,padding:40,
                                border:"1px solid rgba(255,255,255,0.06)",
                                textAlign:"center",
                            }}>
                                <div style={{fontFamily:"var(--serif)",fontSize:"clamp(22px,3vw,32px)",lineHeight:1.4,color:"#fff",marginBottom:16}}>
                                    Prendy is the OS that makes social life <em style={{fontStyle:"italic",color:"var(--violet)"}}>effortless</em> again.
                                </div>
                                <p style={{fontSize:15,color:"rgba(255,255,255,0.5)",maxWidth:480,margin:"0 auto",lineHeight:1.6}}>
                                    We handle the operations so you can focus on the only thing that actually matters: being with each other.
                                </p>
                            </div>

                            {/* Infrastructure pillars */}
                            <div style={{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(200px,1fr))",gap:16,marginTop:32}}>
                                {[
                                    { icon:"blueprint", label:"Success Blueprints", desc:"Repeatable formulas for every kind of gathering", color:"var(--violet)" },
                                    { icon:"zap", label:"Instant Logistics", desc:"AI-powered vendor matching and supply routing", color:"var(--amber)" },
                                    { icon:"users", label:"Built for Hosts", desc:"The initiator never burns out again", color:"var(--rose)" },
                                    { icon:"globe", label:"Local Intelligence", desc:"Live data from Santiago's best vendors & stores", color:"var(--sage)" },
                                ].map(p=>(
                                    <div key={p.label} style={{padding:24,borderRadius:16,background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.06)"}}>
                                        <div style={{width:40,height:40,borderRadius:12,background:"rgba(255,255,255,0.06)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:12}}>
                                            <Icon name={p.icon} size={20} color={p.color}/>
                                        </div>
                                        <div style={{fontWeight:700,fontSize:14,color:"#fff",marginBottom:4}}>{p.label}</div>
                                        <div style={{fontSize:12,lineHeight:1.5,color:"rgba(255,255,255,0.5)"}}>{p.desc}</div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>

                {/* Final CTA */}
                <div style={{textAlign:"center",padding:"80px 24px 60px",maxWidth:640,margin:"0 auto"}}>
                    <h2 style={{fontFamily:"var(--serif)",fontSize:"clamp(28px,4vw,42px)",lineHeight:1.1,marginBottom:16}}>Ready to plan your<br/><em style={{fontStyle:"italic",color:"var(--rose)"}}>next gathering?</em></h2>
                    <p style={{fontSize:17,color:"var(--stone)",lineHeight:1.6,marginBottom:36}}>
                        Generate your free AI Blueprint in 30 seconds. No account needed.
                    </p>
                    <button onClick={onStart} style={{padding:"18px 52px",borderRadius:100,border:"none",background:"linear-gradient(135deg,var(--rose),var(--violet))",color:"#fff",fontSize:17,fontWeight:600,boxShadow:"0 12px 40px rgba(124,92,224,0.2)"}}>Start Planning Free ‚Üí</button>
                    <div style={{marginTop:20,fontSize:13,color:"var(--stone)"}} >Free forever ¬∑ No sign-up ¬∑ Santiago, Chile</div>
                </div>

                {/* Footer */}
                <footer style={{borderTop:"1px solid var(--border)",padding:"48px 24px 32px",maxWidth:960,margin:"0 auto"}}>
                    <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:32,marginBottom:40}}>
                        <div>
                            <div style={{fontFamily:"var(--serif)",fontSize:24,marginBottom:8}}>Prendy</div>
                            <p style={{fontSize:14,color:"var(--stone)",maxWidth:280,lineHeight:1.6}}>The Logistics OS for Gatherings. AI-powered event planning for Santiago, Chile.</p>
                        </div>
                        <div style={{display:"flex",gap:48,flexWrap:"wrap"}}>
                            <div>
                                <div style={{fontWeight:700,fontSize:12,textTransform:"uppercase",letterSpacing:".1em",color:"var(--stone)",marginBottom:12}}>Product</div>
                                <div style={{display:"flex",flexDirection:"column",gap:8}}>
                                    <span style={{fontSize:14,color:"var(--ink)",cursor:"pointer"}} onClick={onStart}>Create Blueprint</span>
                                    <span style={{fontSize:14,color:"var(--stone)"}}>Vendors</span>
                                    <span style={{fontSize:14,color:"var(--stone)"}}>Pricing</span>
                                </div>
                            </div>
                            <div>
                                <div style={{fontWeight:700,fontSize:12,textTransform:"uppercase",letterSpacing:".1em",color:"var(--stone)",marginBottom:12}}>Company</div>
                                <div style={{display:"flex",flexDirection:"column",gap:8}}>
                                    <span style={{fontSize:14,color:"var(--stone)"}}>About</span>
                                    <span style={{fontSize:14,color:"var(--stone)"}}>Contact</span>
                                    <span style={{fontSize:14,color:"var(--stone)"}}>Santiago, Chile</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style={{borderTop:"1px solid var(--border)",paddingTop:24,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:12}}>
                        <div style={{fontSize:13,color:"var(--stone)"}}>¬© 2025 Prendy. All rights reserved.</div>
                        <div style={{fontSize:13,color:"var(--stone)"}}>Made with love in Santiago üá®üá±</div>
                    </div>
                </footer>
            </div>
        );

       const Onboarding = ({ onFinish }) => {
  const [step, setStep] = useState(0);

  const [form, setForm] = useState({
    scenarioKey: "",
    type: "",
    hostingMode: "",   // "home" | "venue"
    venueStyle: "",    // only if hostingMode === "venue"
    tier: "",          // "value" | "standard" | "premium"
    guestCount: "",
    budget: "",
    date: "",
    setting: "",
    vibe: "",
    dietary: "",
    notes: "",
  });

  const up = (k, v) => setForm((f) => ({ ...f, [k]: v }));
  const next = () => setStep((s) => Math.min(s + 1, 50));
  const back = () => setStep((s) => Math.max(0, s - 1));

  const CURATED = [
    { key: "adult_birthday", emoji: "üéÇ", title: "Adult Birthday", desc: "10‚Äì25 guests", type: "Birthday" },
    { key: "kids_birthday", emoji: "üß∏", title: "Kids Birthday", desc: "15‚Äì40 guests", type: "Birthday" },
    { key: "farewell_drinks", emoji: "üçª", title: "Farewell Drinks / Bar Meetup", desc: "10‚Äì35 guests", type: "House Party" },
    { key: "family_lunch", emoji: "üçΩÔ∏è", title: "Family Lunch Hosting", desc: "12‚Äì30 guests", type: "Dinner Party" },
    { key: "bachelorette", emoji: "üíÉ", title: "Bachelorette / Pre-party", desc: "8‚Äì20 guests", type: "House Party" },
    { key: "baptism_communion", emoji: "‚õ™", title: "Baptism / First Communion", desc: "15‚Äì25 guests", type: "Dinner Party" },
    { key: "other", emoji: "‚ú®", title: "Other", desc: "Use generic event types", type: "" },
  ];

  const GENERIC_TYPES = [
    { t: "Dinner Party", e: "üç∑", d: "Intimate seated meal" },
    { t: "Birthday", e: "üéÇ", d: "Celebration with food & fun" },
    { t: "Corporate Meetup", e: "üíº", d: "Team event or offsite" },
    { t: "House Party", e: "üéâ", d: "Casual drinks & music" },
    { t: "Wedding Reception", e: "üíí", d: "Post-ceremony celebration" },
  ];

  const GUEST_BUCKETS = ["10-20", "20-40", "40-60", "60-100", "100+"];
  const BUDGET_BUCKETS = [
    { v: "500000", l: "$500K" },
    { v: "1000000", l: "$1M" },
    { v: "2000000", l: "$2M" },
    { v: "5000000", l: "$5M" },
    { v: "10000000", l: "$10M+" },
  ];

  const VIBE_OPTIONS = [
    { v: "Casual & Relaxed", e: "üòå", d: "Chill, no dress code" },
    { v: "Elegant & Refined", e: "‚ú®", d: "Upscale, polished" },
    { v: "Party & High-Energy", e: "üî•", d: "Music, dancing, late night" },
    { v: "Cozy & Intimate", e: "üïØÔ∏è", d: "Small group, warm" },
  ];

  const steps = [];

  // STEP ‚Äî Scenario (curated)
  steps.push({
    key: "scenario",
    content: (
      <div className="fade-up">
        <h2 style={{ fontFamily: "var(--serif)", fontSize: 36, marginBottom: 8 }}>
          What are you planning?
        </h2>
        <p style={{ color: "var(--stone)", marginBottom: 24 }}>
          Choose a curated scenario ‚Äî or select <b>Other</b>.
        </p>

        <div style={{ display: "flex", flexDirection: "column", gap: 12 }}>
          {CURATED.map((o) => (
            <OptionCard
              key={o.key}
              selected={form.scenarioKey === o.key}
              onClick={() => {
                up("scenarioKey", o.key);
                if (o.key !== "other") up("type", o.type);
                if (o.key === "other") up("type", "");
                setTimeout(next, 120);
              }}
              emoji={o.emoji}
              title={o.title}
              desc={o.desc}
            />
          ))}
        </div>
      </div>
    ),
  });

  // STEP ‚Äî Generic type (only if Other)
  if (form.scenarioKey === "other") {
    steps.push({
      key: "generic",
      content: (
        <div className="fade-up">
          <h2 style={{ fontFamily: "var(--serif)", fontSize: 36, marginBottom: 8 }}>
            Select event type
          </h2>
          <p style={{ color: "var(--stone)", marginBottom: 24 }}>
            We‚Äôll customize from here.
          </p>

          <div style={{ display: "flex", flexDirection: "column", gap: 12 }}>
            {GENERIC_TYPES.map((o) => (
              <OptionCard
                key={o.t}
                selected={form.type === o.t}
                onClick={() => {
                  up("type", o.t);
                  setTimeout(next, 120);
                }}
                emoji={o.e}
                title={o.t}
                desc={o.d}
              />
            ))}
          </div>
        </div>
      ),
    });
  }

  // STEP ‚Äî Hosting
  steps.push({
    key: "hosting",
    content: (
      <div className="fade-up">
        <h2 style={{ fontFamily: "var(--serif)", fontSize: 36, marginBottom: 8 }}>
          How are you hosting?
        </h2>
        <p style={{ color: "var(--stone)", marginBottom: 24 }}>
          This changes execution (groceries vs. booking packages).
        </p>

        <label style={{ fontWeight: 600, fontSize: 14, display: "block", marginBottom: 8 }}>
          Hosting mode
        </label>
        <div style={{ display: "flex", gap: 10, marginBottom: 18, flexWrap: "wrap" }}>
          <Chip selected={form.hostingMode === "home"} onClick={() => { up("hostingMode", "home"); up("venueStyle", ""); }}>
            At Home
          </Chip>
          <Chip selected={form.hostingMode === "venue"} onClick={() => up("hostingMode", "venue")}>
            Venue / Restaurant
          </Chip>
        </div>

        {form.hostingMode === "venue" && (
          <>
            <label style={{ fontWeight: 600, fontSize: 14, display: "block", marginBottom: 8 }}>
              Venue style
            </label>
            <div style={{ display: "flex", gap: 10, marginBottom: 18, flexWrap: "wrap" }}>
              {["Burger Joint", "French Bistro", "Dive Bar", "Rooftop Bar", "Cocktail Bar", "Family Restaurant"].map((s) => (
                <Chip key={s} selected={form.venueStyle === s} onClick={() => up("venueStyle", s)}>
                  {s}
                </Chip>
              ))}
            </div>
          </>
        )}

        <label style={{ fontWeight: 600, fontSize: 14, display: "block", marginBottom: 8 }}>
          Recommendation level
        </label>
        <div style={{ display: "flex", gap: 10, flexWrap: "wrap" }}>
          <Chip selected={form.tier === "value"} onClick={() => up("tier", "value")}>Value</Chip>
          <Chip selected={form.tier === "standard"} onClick={() => up("tier", "standard")}>Signature</Chip>
          <Chip selected={form.tier === "premium"} onClick={() => up("tier", "premium")}>Elevated</Chip>
        </div>

        <div style={{ color: "var(--stone)", fontSize: 12, marginTop: 10 }}>
          (This powers specific recommendations like brand/examples, not generic ‚Äúcheese & crackers‚Äù.)
        </div>
      </div>
    ),
  });

  // STEP ‚Äî Scale
  steps.push({
    key: "scale",
    content: (
      <div className="fade-up">
        <h2 style={{ fontFamily: "var(--serif)", fontSize: 36, marginBottom: 8 }}>
          The scale
        </h2>
        <p style={{ color: "var(--stone)", marginBottom: 24 }}>
          How many people and what‚Äôs the budget?
        </p>

        <label style={{ fontWeight: 600, fontSize: 14, display: "block", marginBottom: 8 }}>
          Guest count
        </label>
        <div style={{ display: "flex", gap: 10, marginBottom: 18, flexWrap: "wrap" }}>
          {GUEST_BUCKETS.map((g) => (
            <Chip key={g} selected={form.guestCount === g} onClick={() => up("guestCount", g)}>
              {g}
            </Chip>
          ))}
        </div>

        <label style={{ fontWeight: 600, fontSize: 14, display: "block", marginBottom: 8 }}>
          Total budget (CLP)
        </label>
        <div style={{ display: "flex", gap: 10, marginBottom: 18, flexWrap: "wrap" }}>
          {BUDGET_BUCKETS.map((b) => (
            <Chip key={b.v} selected={form.budget === b.v} onClick={() => up("budget", b.v)}>
              {b.l}
            </Chip>
          ))}
        </div>

        <label style={{ fontWeight: 600, fontSize: 14, display: "block", marginBottom: 8 }}>
          Preferred date (optional)
        </label>
        <input
          type="date"
          value={form.date}
          onChange={(e) => up("date", e.target.value)}
        />
      </div>
    ),
  });

  // STEP ‚Äî Vibe
  steps.push({
    key: "vibe",
    content: (
      <div className="fade-up">
        <h2 style={{ fontFamily: "var(--serif)", fontSize: 36, marginBottom: 8 }}>
          The vibe
        </h2>
        <p style={{ color: "var(--stone)", marginBottom: 24 }}>
          Helps us match vendors and plan the flow.
        </p>

        <label style={{ fontWeight: 600, fontSize: 14, display: "block", marginBottom: 8 }}>
          Setting
        </label>
        <div style={{ display: "flex", gap: 10, marginBottom: 18, flexWrap: "wrap" }}>
          {[
            { v: "indoor", e: "üè†", l: "Indoor" },
            { v: "outdoor", e: "üå≥", l: "Outdoor" },
            { v: "mixed", e: "üè°", l: "Mixed" },
          ].map((s) => (
            <Chip key={s.v} selected={form.setting === s.v} onClick={() => up("setting", s.v)}>
              {s.e} {s.l}
            </Chip>
          ))}
        </div>

        <label style={{ fontWeight: 600, fontSize: 14, display: "block", marginBottom: 8 }}>
          Vibe
        </label>
        <div style={{ display: "flex", flexDirection: "column", gap: 10, marginBottom: 18 }}>
          {VIBE_OPTIONS.map((v) => (
            <OptionCard
              key={v.v}
              selected={form.vibe === v.v}
              onClick={() => up("vibe", v.v)}
              emoji={v.e}
              title={v.v}
              desc={v.d}
            />
          ))}
        </div>

        <label style={{ fontWeight: 600, fontSize: 14, display: "block", marginBottom: 8 }}>
          Dietary requirements (optional)
        </label>
        <input
          placeholder="e.g. vegetarian, gluten-free, no shellfish"
          value={form.dietary}
          onChange={(e) => up("dietary", e.target.value)}
          style={{ marginBottom: 16 }}
        />

        <label style={{ fontWeight: 600, fontSize: 14, display: "block", marginBottom: 8 }}>
          Anything else? (optional)
        </label>
        <textarea
          placeholder="e.g. surprise cake at 18:00, DJ reggaeton, kids activities..."
          value={form.notes}
          onChange={(e) => up("notes", e.target.value)}
          rows={4}
          style={{ resize: "vertical" }}
        />
      </div>
    ),
  });

  const totalSteps = steps.length;

  const isStepValid = () => {
    const k = steps[step]?.key;
    switch (k) {
      case "scenario":
        return !!form.scenarioKey;

      case "generic":
        return !!form.type;

      case "hosting":
        return (
          !!form.hostingMode &&
          !!form.tier &&
          (form.hostingMode !== "venue" || !!form.venueStyle)
        );

      case "scale":
        return !!form.guestCount && !!form.budget;

      case "vibe":
        return !!form.setting && !!form.vibe;

      default:
        return true;
    }
  };

  const safeSetStep = (n) => {
    const clamped = Math.max(0, Math.min(n, totalSteps - 1));
    setStep(clamped);
  };

  // If scenarioKey changes and removes/ adds the "generic" step, keep step in bounds
  useEffect(() => {
    if (step > totalSteps - 1) safeSetStep(totalSteps - 1);
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [totalSteps]);

  return (
    <div style={{ maxWidth: 560, margin: "40px auto", padding: "0 24px" }}>
      <ProgressBar step={step} total={totalSteps} />

      {steps[step]?.content}

      <div style={{ display: "flex", justifyContent: "space-between", marginTop: 40, gap: 12 }}>
        {step > 0 ? (
          <button
            onClick={back}
            style={{
              padding: "14px 28px",
              borderRadius: 100,
              border: "1.5px solid var(--border)",
              background: "transparent",
              fontWeight: 600,
              fontSize: 15,
            }}
          >
            ‚Üê Back
          </button>
        ) : (
          <div />
        )}

        {step < totalSteps - 1 ? (
          <button
            onClick={next}
            disabled={!isStepValid()}
            style={{
              padding: "14px 36px",
              borderRadius: 100,
              border: "none",
              background: isStepValid() ? "var(--ink)" : "var(--border)",
              color: isStepValid() ? "#fff" : "var(--stone)",
              fontWeight: 600,
              fontSize: 15,
            }}
          >
            Continue ‚Üí
          </button>
        ) : (
          <button
            onClick={() => onFinish(form)}
            disabled={!isStepValid()}
            style={{
              padding: "14px 36px",
              borderRadius: 100,
              border: "none",
              background: "linear-gradient(135deg,var(--rose),var(--violet))",
              color: "#fff",
              fontWeight: 600,
              fontSize: 15,
              opacity: isStepValid() ? 1 : 0.55,
              boxShadow: "0 8px 24px rgba(124,92,224,0.2)",
            }}
          >
            Generate Blueprint üöÄ
          </button>
        )}
      </div>
    </div>
  );
};
        const Loading = ({ error }) => {
            const [msg,setMsg]=useState(0);
            const msgs=["Analyzing event parameters...","Calculating supply logistics...","Matching vendors to your vibe...","Building timeline...","Routing items to stores...","Estimating prices...","Finalizing Blueprint..."];
            useEffect(()=>{const iv=setInterval(()=>setMsg(m=>(m+1)%msgs.length),1800);return()=>clearInterval(iv);},[]);
            return(<div style={{textAlign:"center",padding:"120px 24px",maxWidth:480,margin:"0 auto"}}><div style={{width:48,height:48,border:"3px solid var(--border)",borderTopColor:"var(--violet)",borderRadius:"50%",animation:"spin .8s linear infinite",margin:"0 auto 32px"}}/><h2 style={{fontFamily:"var(--serif)",fontSize:28,marginBottom:12}}>Building Your Blueprint</h2><p key={msg} style={{color:"var(--stone)",animation:"fadeIn .3s ease"}}>{msgs[msg]}</p>{error && <p style={{color:"#c0392b",fontSize:13,marginTop:16}}>{error}</p>}</div>);
        };

        /* =========================================
           BLUEPRINT VIEW
           ========================================= */
        const Blueprint = ({ data, blueprint, vendors }) => {
            const [tab, setTab] = useState('overview');
            const [bookingVendor, setBookingVendor] = useState(null);
            const [bookings, setBookings] = useState([]);
            const [toast, setToast] = useState(null);
            const totalBudget = parseInt(data.budget) || 2000000;
            const bp = blueprint;

            const showToast = (msg) => { setToast(msg); setTimeout(() => setToast(null), 3000); };

            const handleBookingConfirm = (booking) => {
                setBookings(prev => [...prev, booking]);
                showToast(`‚úì Booked ${booking.vendor.name}!`);
            };

            const tabs = [
                { id:'overview', label:'Overview', icon:'üìä' },
                { id:'shop', label:'Shop & Order', icon:'üõí' },
                { id:'vendors', label:'Book Vendors', icon:'üìÖ' },
                { id:'timeline', label:'Timeline', icon:'‚è∞' },
                { id:'supplies', label:'Supplies', icon:'üì¶' },
            ];

            return (
                <div style={{ maxWidth:900, margin:"0 auto", padding:"32px 24px 80px" }}>
                    <div className="fade-up" style={{ marginBottom:12 }}>
                        <div className="pill" style={{ background:"rgba(61,139,110,0.08)", color:"var(--sage)", marginBottom:16 }}>‚úì Blueprint Generated</div>
                        <h1 style={{ fontFamily:"var(--serif)", fontSize:"clamp(32px,5vw,48px)", marginBottom:8 }}>{data.type}</h1>
                        <p style={{ color:"var(--stone)", fontSize:16, maxWidth:600, lineHeight:1.5 }}>{bp.summary}</p>
                    </div>

                    <div className="fade-up-d1" style={{ display:"grid", gridTemplateColumns:"repeat(auto-fit,minmax(130px,1fr))", gap:12, margin:"28px 0 36px" }}>
                        <StatCard label="Guests" value={data.guestCount}/>
                        <StatCard label="Budget" value={fmtCLP(totalBudget)} sub="CLP"/>
                        <StatCard label="Staff" value={bp.staffing.servers+bp.staffing.bartenders+bp.staffing.setup_crew} sub="needed"/>
                        <StatCard label="Booked" value={bookings.length} sub="vendors" color={bookings.length>0?"var(--sage)":undefined}/>
                    </div>

                    {/* Tabs */}
                    <div className="fade-up-d2" style={{ display:"flex", gap:4, background:"var(--warm)", borderRadius:14, padding:4, marginBottom:32, overflowX:"auto" }}>
                        {tabs.map(t => (
                            <button key={t.id} onClick={() => setTab(t.id)} style={{
                                flex:1, padding:"12px 6px", borderRadius:10, border:"none",
                                background:tab===t.id?"var(--card)":"transparent",
                                fontWeight:tab===t.id?600:500, fontSize:13,
                                color:tab===t.id?"var(--ink)":"var(--stone)",
                                boxShadow:tab===t.id?"0 2px 8px rgba(0,0,0,0.04)":"none",
                                whiteSpace:"nowrap",
                            }}>{t.icon} {t.label}</button>
                        ))}
                    </div>

                    {/* Overview */}
                    {tab === 'overview' && (
                        <div className="fade-up">
                            <div className="card" style={{marginBottom:20}}>
                                <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:24}}>Budget Allocation</h3>
                                <BudgetDonut budget={bp.budget} total={totalBudget}/>
                            </div>
                            <div className="card" style={{marginBottom:20}}>
                                <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:16}}>Staffing</h3>
                                <div style={{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:12}}>
                                    {[['servers','Servers'],['bartenders','Bartenders'],['setup_crew','Setup Crew']].map(([k,l])=>(
                                        <div key={k} style={{padding:16,background:"var(--warm)",borderRadius:14,textAlign:"center"}}><div style={{fontSize:24,fontWeight:700}}>{bp.staffing[k]}</div><div style={{fontSize:13,color:"var(--stone)"}}>{l}</div></div>
                                    ))}
                                </div>
                            </div>

                            {/* Active bookings */}
                            {bookings.length > 0 && (
                                <div className="card" style={{marginBottom:20,borderColor:"rgba(61,139,110,0.2)"}}>
                                    <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:16}}>üé´ Your Bookings</h3>
                                    {bookings.map((b,i)=>(
                                        <div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 16px",background:i%2===0?"var(--warm)":"transparent",borderRadius:12,marginBottom:4}}>
                                            <div style={{display:"flex",gap:12,alignItems:"center"}}>
                                                <span style={{fontSize:22}}>{b.vendor.img}</span>
                                                <div>
                                                    <div style={{fontWeight:600,fontSize:14}}>{b.vendor.name} ‚Äî {b.pkg.name}</div>
                                                    <div style={{fontSize:12,color:"var(--stone)"}}>{b.date} at {b.time} ¬∑ Ref: {b.ref}</div>
                                                </div>
                                            </div>
                                            <div className="pill" style={{background:"rgba(61,139,110,0.08)",color:"var(--sage)"}}>‚úì Confirmed</div>
                                        </div>
                                    ))}
                                </div>
                            )}

                            {/* Quick CTAs */}
                            <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:20}}>
                                <div className="card" onClick={()=>setTab('shop')} style={{cursor:"pointer",borderColor:"rgba(0,51,160,0.12)",padding:20}}>
                                    <span style={{fontSize:28}}>üõí</span>
                                    <div style={{fontWeight:700,fontSize:14,marginTop:8}}>Order Groceries</div>
                                    <div style={{fontSize:12,color:"var(--stone)",marginTop:2}}>Pre-built lists for Lider, Rappi & more</div>
                                </div>
                                <div className="card" onClick={()=>setTab('vendors')} style={{cursor:"pointer",borderColor:"rgba(124,92,224,0.12)",padding:20}}>
                                    <span style={{fontSize:28}}>üìÖ</span>
                                    <div style={{fontWeight:700,fontSize:14,marginTop:8}}>Book Vendors</div>
                                    <div style={{fontSize:12,color:"var(--stone)",marginTop:2}}>Catering, venue, DJ & more</div>
                                </div>
                            </div>

                            <div className="card">
                                <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:16}}>Pro Tips</h3>
                                {bp.tips.map((tip,i)=>(<div key={i} style={{display:"flex",gap:12,padding:"12px 0",borderBottom:i<bp.tips.length-1?"1px solid var(--border)":"none"}}><span style={{flexShrink:0}}>üí°</span><span style={{fontSize:14,lineHeight:1.5}}>{tip}</span></div>))}
                                {bp.risks&&bp.risks.length>0&&(<><h4 style={{marginTop:20,marginBottom:12,fontSize:15,fontWeight:600}}>Risk Mitigation</h4>{bp.risks.map((r,i)=>(<div key={i} style={{display:"flex",gap:12,padding:"12px 0",borderBottom:i<bp.risks.length-1?"1px solid var(--border)":"none"}}><span style={{flexShrink:0}}>‚ö†Ô∏è</span><span style={{fontSize:14,lineHeight:1.5}}>{r}</span></div>))}</>)}
                            </div>
                        </div>
                    )}

                    {/* Shop */}
                    {tab === 'shop' && <ShopTab supplies={bp.supplies} blueprintText={bp.blueprint} />}

                    {/* Vendors (booking) */}
                    {tab === 'vendors' && (
                        <div className="fade-up">
                            {bookings.length > 0 && (
                                <div className="card" style={{marginBottom:24,background:"rgba(61,139,110,0.03)",borderColor:"rgba(61,139,110,0.15)"}}>
                                    <div style={{display:"flex",alignItems:"center",gap:10,marginBottom:12}}>
                                        <span style={{fontSize:20}}>üé´</span>
                                        <h4 style={{fontWeight:700}}>Active Bookings ({bookings.length})</h4>
                                    </div>
                                    {bookings.map((b,i)=>(
                                        <div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 0",borderBottom:i<bookings.length-1?"1px solid var(--border)":"none"}}>
                                            <div style={{display:"flex",gap:10,alignItems:"center"}}>
                                                <span>{b.vendor.img}</span>
                                                <div><div style={{fontSize:14,fontWeight:600}}>{b.vendor.name}</div><div style={{fontSize:12,color:"var(--stone)"}}>{b.pkg.name} ¬∑ {b.date}</div></div>
                                            </div>
                                            <span style={{fontSize:13,fontWeight:600,color:"var(--sage)"}}>{fmtCLP(b.price)}</span>
                                        </div>
                                    ))}
                                    <div style={{display:"flex",justifyContent:"space-between",marginTop:12,paddingTop:12,borderTop:"1.5px solid var(--border)"}}>
                                        <span style={{fontWeight:600}}>Total booked</span>
                                        <span style={{fontWeight:700,color:"var(--violet)",fontFamily:"var(--serif)",fontSize:18}}>{fmtCLP(bookings.reduce((s,b)=>s+b.price,0))}</span>
                                    </div>
                                </div>
                            )}

                            {Object.entries(vendors).map(([cat, list]) => (
                                <div key={cat} style={{ marginBottom:28 }}>
                                    <h3 style={{ fontFamily:"var(--serif)", fontSize:20, marginBottom:14, textTransform:"capitalize" }}>{cat}</h3>
                                    <div style={{ display:"flex", flexDirection:"column", gap:12 }}>
                                        {list.map(v => {
                                            const isBooked = bookings.some(b => b.vendor.id === v.id);
                                            return (
                                                <div key={v.name} style={{position:"relative"}}>
                                                    <VendorCard vendor={v} onBook={setBookingVendor} />
                                                    {isBooked && (
                                                        <div style={{position:"absolute",top:12,right:12,background:"var(--sage)",color:"#fff",padding:"4px 12px",borderRadius:100,fontSize:12,fontWeight:700}}>‚úì Booked</div>
                                                    )}
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}

                    {/* Timeline */}
                    {tab === 'timeline' && (
                        <div className="fade-up"><div className="card"><h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:24}}>Event Day Timeline</h3>{bp.timeline.map((e,i)=>(<div key={i} style={{display:"flex",gap:20,padding:"16px 0",borderBottom:i<bp.timeline.length-1?"1px solid var(--border)":"none",animation:`slideIn .3s ease ${i*.05}s forwards`,opacity:0}}><div style={{fontWeight:700,fontSize:14,color:"var(--violet)",minWidth:56,fontVariantNumeric:"tabular-nums"}}>{e.time}</div><div style={{flex:1}}><div style={{fontWeight:500,fontSize:14}}>{e.task}</div><div style={{fontSize:12,color:"var(--stone)",marginTop:2}}>{e.owner}</div></div></div>))}</div></div>
                    )}

          {/* Supplies */}
{tab === 'supplies' && (
  <div className="fade-up">
    <div
      style={{
        whiteSpace: "pre-wrap",
        fontFamily:
          "system-ui, -apple-system, BlinkMacSystemFont, sans-serif",
        fontSize: 14,
        lineHeight: 1.5,
        marginTop: 16,
      }}
    >
      {bp && (bp.shopping_list || bp.blueprint)
        ? (bp.shopping_list || bp.blueprint)
        : "(Generate a blueprint to see your detailed menu and shopping plan here.)"}
    </div>
  </div>
)}





                    {/* Booking Modal */}
                    {bookingVendor && (
                        <BookingModal
                            vendor={bookingVendor}
                            eventData={data}
                            onClose={() => setBookingVendor(null)}
                            onConfirm={handleBookingConfirm}
                        />
                    )}

                    <Toast message={toast} visible={!!toast} />
                </div>
            );
        };

        /* =========================================
           VENDOR DASHBOARD
           ========================================= */
        const VendorDashboard = () => {
            const [tab, setTab] = useState('overview');
            const [selectedCategory, setSelectedCategory] = useState('all');

            // Simulated vendor-side data
            const myProfile = VENDORS.catering[0]; // Demo: logged in as Mestiza Banquetes
            const [bookingRequests] = useState([
                { id:1, client:"Camila R.", event:"Birthday Party", date:"2025-03-15", time:"19:00", guests:45, pkg:"Full Dinner", status:"confirmed", amount:1575000, notes:"3 vegetarians" },
                { id:2, client:"Diego M.", event:"Corporate Meetup", date:"2025-03-22", time:"18:00", guests:80, pkg:"Cocktail Standing", status:"pending", amount:2000000, notes:"AV setup needed" },
                { id:3, client:"Valentina L.", event:"Dinner Party", date:"2025-04-05", time:"20:00", guests:25, pkg:"Aperitivo", status:"confirmed", amount:450000, notes:"Pisco sour station" },
                { id:4, client:"Andr√©s K.", event:"Wedding Reception", date:"2025-04-12", time:"17:00", guests:120, pkg:"Full Dinner", status:"pending", amount:4200000, notes:"Outdoor, backup plan needed" },
                { id:5, client:"Sof√≠a T.", event:"House Party", date:"2025-03-08", time:"21:00", guests:35, pkg:"Cocktail Standing", status:"completed", amount:875000, notes:"" },
            ]);

            const totalRevenue = bookingRequests.filter(b=>b.status==='confirmed'||b.status==='completed').reduce((s,b)=>s+b.amount,0);
            const pendingRevenue = bookingRequests.filter(b=>b.status==='pending').reduce((s,b)=>s+b.amount,0);
            const confirmedCount = bookingRequests.filter(b=>b.status==='confirmed').length;
            const pendingCount = bookingRequests.filter(b=>b.status==='pending').length;

            const statusColors = { confirmed:"var(--sage)", pending:"var(--amber)", completed:"var(--stone)" };
            const statusBg = { confirmed:"rgba(61,139,110,.08)", pending:"rgba(212,147,10,.08)", completed:"rgba(138,133,120,.08)" };

            const tabs = [
                { id:'overview', label:'Overview', icon:'üìä' },
                { id:'bookings', label:'Bookings', icon:'üìã' },
                { id:'packages', label:'My Packages', icon:'üì¶' },
                { id:'reviews', label:'Reviews', icon:'‚≠ê' },
            ];

            return (
                <div style={{maxWidth:900,margin:"0 auto",padding:"32px 24px 80px"}}>
                    <div className="fade-up" style={{marginBottom:12}}>
                        <div className="pill" style={{background:"rgba(212,83,106,.08)",color:"var(--rose)",marginBottom:16}}>üè™ Vendor Dashboard</div>
                        <div style={{display:"flex",alignItems:"center",gap:16,marginBottom:8}}>
                            <div style={{fontSize:40,width:64,height:64,borderRadius:18,background:"var(--warm)",display:"flex",alignItems:"center",justifyContent:"center"}}>{myProfile.img}</div>
                            <div>
                                <h1 style={{fontFamily:"var(--serif)",fontSize:"clamp(28px,5vw,40px)"}}>{myProfile.name}</h1>
                                <p style={{color:"var(--stone)",fontSize:15}}>{myProfile.specialty} ¬∑ {myProfile.area}</p>
                            </div>
                        </div>
                    </div>

                    <div className="fade-up-d1" style={{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(140px,1fr))",gap:12,margin:"28px 0 36px"}}>
                        <StatCard label="Total Revenue" value={fmtCLP(totalRevenue)} color="var(--sage)"/>
                        <StatCard label="Pending" value={fmtCLP(pendingRevenue)} sub="awaiting" color="var(--amber)"/>
                        <StatCard label="Confirmed" value={confirmedCount} sub="bookings"/>
                        <StatCard label="Rating" value={"‚òÖ "+myProfile.rating} color="var(--amber)"/>
                    </div>

                    <div className="fade-up-d2" style={{display:"flex",gap:4,background:"var(--warm)",borderRadius:14,padding:4,marginBottom:32,overflowX:"auto"}}>
                        {tabs.map(t=>(<button key={t.id} onClick={()=>setTab(t.id)} style={{flex:1,padding:"12px 6px",borderRadius:10,border:"none",background:tab===t.id?"var(--card)":"transparent",fontWeight:tab===t.id?600:500,fontSize:13,color:tab===t.id?"var(--ink)":"var(--stone)",boxShadow:tab===t.id?"0 2px 8px rgba(0,0,0,.04)":"none",whiteSpace:"nowrap"}}>{t.icon} {t.label}</button>))}
                    </div>

                    {tab==='overview' && (
                        <div className="fade-up">
                            <div className="card" style={{marginBottom:20,background:"linear-gradient(135deg,rgba(61,139,110,.04),rgba(124,92,224,.04))"}}>
                                <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:20}}>Revenue Overview</h3>
                                <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16}}>
                                    <div style={{padding:20,background:"rgba(61,139,110,.06)",borderRadius:16,textAlign:"center"}}>
                                        <div style={{fontSize:13,color:"var(--stone)",marginBottom:6}}>This Month</div>
                                        <div style={{fontFamily:"var(--serif)",fontSize:28,color:"var(--sage)"}}>{fmtCLP(totalRevenue)}</div>
                                    </div>
                                    <div style={{padding:20,background:"rgba(212,147,10,.06)",borderRadius:16,textAlign:"center"}}>
                                        <div style={{fontSize:13,color:"var(--stone)",marginBottom:6}}>Pipeline</div>
                                        <div style={{fontFamily:"var(--serif)",fontSize:28,color:"var(--amber)"}}>{fmtCLP(pendingRevenue)}</div>
                                    </div>
                                </div>
                            </div>
                            <div className="card" style={{marginBottom:20}}>
                                <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:16}}>Upcoming Bookings</h3>
                                {bookingRequests.filter(b=>b.status!=='completed').sort((a,b)=>a.date.localeCompare(b.date)).map((b,i)=>(
                                    <div key={b.id} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 16px",background:i%2===0?"var(--warm)":"transparent",borderRadius:12,marginBottom:4}}>
                                        <div>
                                            <div style={{fontWeight:600,fontSize:14}}>{b.client} ‚Äî {b.event}</div>
                                            <div style={{fontSize:12,color:"var(--stone)",marginTop:2}}>{b.date} at {b.time} ¬∑ {b.guests} guests ¬∑ {b.pkg}</div>
                                        </div>
                                        <div style={{display:"flex",alignItems:"center",gap:8}}>
                                            <span style={{fontWeight:600,fontSize:14}}>{fmtCLP(b.amount)}</span>
                                            <span className="pill" style={{background:statusBg[b.status],color:statusColors[b.status],fontSize:11}}>{b.status}</span>
                                        </div>
                                    </div>
                                ))}
                            </div>
                            <div className="card">
                                <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:16}}>Quick Stats</h3>
                                <div style={{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:12}}>
                                    <div style={{padding:16,background:"var(--warm)",borderRadius:14,textAlign:"center"}}><div style={{fontSize:24,fontWeight:700}}>{bookingRequests.length}</div><div style={{fontSize:13,color:"var(--stone)"}}>Total Bookings</div></div>
                                    <div style={{padding:16,background:"var(--warm)",borderRadius:14,textAlign:"center"}}><div style={{fontSize:24,fontWeight:700}}>{Math.round(bookingRequests.reduce((s,b)=>s+b.guests,0)/bookingRequests.length)}</div><div style={{fontSize:13,color:"var(--stone)"}}>Avg Guests</div></div>
                                    <div style={{padding:16,background:"var(--warm)",borderRadius:14,textAlign:"center"}}><div style={{fontSize:24,fontWeight:700}}>{myProfile.packages.length}</div><div style={{fontSize:13,color:"var(--stone)"}}>Packages</div></div>
                                </div>
                            </div>
                        </div>
                    )}

                    {tab==='bookings' && (
                        <div className="fade-up">
                            <div style={{display:"flex",gap:8,marginBottom:20}}>
                                {['all','pending','confirmed','completed'].map(f=>(
                                    <Chip key={f} selected={selectedCategory===f} onClick={()=>setSelectedCategory(f)}>{f==='all'?'All':f.charAt(0).toUpperCase()+f.slice(1)}</Chip>
                                ))}
                            </div>
                            {bookingRequests.filter(b=>selectedCategory==='all'||b.status===selectedCategory).map(b=>(
                                <div key={b.id} className="card" style={{marginBottom:12}}>
                                    <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12}}>
                                        <div>
                                            <div style={{fontWeight:700,fontSize:16}}>{b.client}</div>
                                            <div style={{fontSize:13,color:"var(--stone)"}}>{b.event} ¬∑ {b.guests} guests</div>
                                        </div>
                                        <span className="pill" style={{background:statusBg[b.status],color:statusColors[b.status]}}>{b.status}</span>
                                    </div>
                                    <div style={{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:12}}>
                                        <div><div style={{fontSize:11,color:"var(--stone)",fontWeight:600}}>DATE</div><div style={{fontSize:14,fontWeight:500}}>{b.date}</div></div>
                                        <div><div style={{fontSize:11,color:"var(--stone)",fontWeight:600}}>TIME</div><div style={{fontSize:14,fontWeight:500}}>{b.time}</div></div>
                                        <div><div style={{fontSize:11,color:"var(--stone)",fontWeight:600}}>PACKAGE</div><div style={{fontSize:14,fontWeight:500}}>{b.pkg}</div></div>
                                    </div>
                                    <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",background:"var(--warm)",borderRadius:12}}>
                                        <span style={{fontSize:14,fontWeight:500}}>{b.notes||"No special notes"}</span>
                                        <span style={{fontFamily:"var(--serif)",fontSize:20,fontWeight:700,color:"var(--violet)"}}>{fmtCLP(b.amount)}</span>
                                    </div>
                                    {b.status==='pending' && (
                                        <div style={{display:"flex",gap:8,marginTop:12}}>
                                            <button style={{flex:1,padding:"10px",borderRadius:12,border:"none",background:"var(--sage)",color:"#fff",fontWeight:600,fontSize:13}}>‚úì Accept</button>
                                            <button style={{flex:1,padding:"10px",borderRadius:12,border:"1.5px solid var(--border)",background:"transparent",fontWeight:600,fontSize:13}}>‚úó Decline</button>
                                            <a href={`https://wa.me/`} target="_blank" rel="noopener" style={{flex:1,padding:"10px",borderRadius:12,border:"none",background:"#25D366",color:"#fff",fontWeight:600,fontSize:13,textDecoration:"none",textAlign:"center"}}>üí¨ Chat</a>
                                        </div>
                                    )}
                                </div>
                            ))}
                        </div>
                    )}

                    {tab==='packages' && (
                        <div className="fade-up">
                            <div className="card" style={{marginBottom:20,background:"linear-gradient(135deg,rgba(124,92,224,.04),rgba(212,83,106,.04))"}}>
                                <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:8}}>Your Packages</h3>
                                <p style={{fontSize:14,color:"var(--stone)"}}>Manage pricing and descriptions for your services</p>
                            </div>
                            {myProfile.packages.map((pkg,i)=>(
                                <div key={i} className="card" style={{marginBottom:12}}>
                                    <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start"}}>
                                        <div>
                                            <div style={{fontWeight:700,fontSize:16}}>{pkg.name}</div>
                                            <div style={{fontSize:14,color:"var(--stone)",marginTop:4}}>{pkg.desc}</div>
                                        </div>
                                        <div style={{textAlign:"right"}}>
                                            <div style={{fontFamily:"var(--serif)",fontSize:22,color:"var(--violet)"}}>{pkg.flatRate?fmtCLP(pkg.flatRate):fmtCLP(pkg.pricePerHead)+"/pp"}</div>
                                            {pkg.minGuests>1 && <div style={{fontSize:12,color:"var(--stone)"}}>min {pkg.minGuests} guests</div>}
                                        </div>
                                    </div>
                                    <div style={{display:"flex",gap:8,marginTop:12}}>
                                        <div style={{padding:"8px 14px",borderRadius:10,background:"var(--warm)",fontSize:12,color:"var(--stone)",fontWeight:500}}>üìä Booked {Math.floor(Math.random()*8)+2} times</div>
                                        <div style={{padding:"8px 14px",borderRadius:10,background:"rgba(61,139,110,.06)",fontSize:12,color:"var(--sage)",fontWeight:500}}>üí∞ {fmtCLP((pkg.flatRate||pkg.pricePerHead*30)*(Math.floor(Math.random()*5)+1))} earned</div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}

                    {tab==='reviews' && (
                        <div className="fade-up">
                            <div className="card" style={{marginBottom:20,textAlign:"center"}}>
                                <div style={{fontFamily:"var(--serif)",fontSize:48,color:"var(--amber)"}}>{myProfile.rating}</div>
                                <div style={{fontSize:20,marginBottom:4}}>{"‚òÖ".repeat(5)}</div>
                                <div style={{fontSize:14,color:"var(--stone)"}}>Based on 23 reviews</div>
                            </div>
                            {[
                                {name:"Camila R.",date:"2025-02-28",stars:5,text:"Absolutely incredible service. The fusion menu was a hit with everyone at the party!"},
                                {name:"Diego M.",date:"2025-02-15",stars:5,text:"Professional, punctual, and the food quality was outstanding. Already rebooked for next quarter."},
                                {name:"Sof√≠a T.",date:"2025-01-20",stars:4,text:"Great cocktail spread. Only minor note: setup took a bit longer than expected."},
                                {name:"Andr√©s K.",date:"2025-01-08",stars:5,text:"Perfect execution. Our guests couldn't stop raving about the ceviche station."},
                            ].map((r,i)=>(
                                <div key={i} className="card" style={{marginBottom:12}}>
                                    <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8}}>
                                        <div style={{fontWeight:600,fontSize:15}}>{r.name}</div>
                                        <div style={{fontSize:13,color:"var(--stone)"}}>{r.date}</div>
                                    </div>
                                    <div style={{color:"var(--amber)",marginBottom:8}}>{"‚òÖ".repeat(r.stars)}{"‚òÜ".repeat(5-r.stars)}</div>
                                    <p style={{fontSize:14,lineHeight:1.6,color:"var(--stone)"}}>{r.text}</p>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        };

        /* =========================================
           VENUE DASHBOARD
           ========================================= */
        const VenueDashboard = () => {
            const [tab, setTab] = useState('overview');
            const myVenue = VENDORS.venues[0]; // Demo: logged in as Lastarria Loft

            const [bookings] = useState([
                { id:1, client:"Camila R.", event:"Birthday Party", date:"2025-03-15", time:"17:00-23:00", guests:45, pkg:"Half Day (6h)", status:"confirmed", amount:450000 },
                { id:2, client:"Diego M.", event:"Corporate Meetup", date:"2025-03-22", time:"14:00-02:00", pkg:"Full Day (12h)", guests:80, status:"confirmed", amount:780000 },
                { id:3, client:"Valentina L.", event:"Dinner Party", date:"2025-04-05", time:"18:00-00:00", guests:25, pkg:"Half Day (6h)", status:"pending", amount:450000 },
                { id:4, client:"Mart√≠n S.", event:"Wedding Reception", date:"2025-04-12", time:"14:00-02:00", guests:100, pkg:"Full Day + Bar", status:"pending", amount:1100000 },
                { id:5, client:"NotCo Team", event:"Corporate Event", date:"2025-03-08", time:"14:00-02:00", guests:60, pkg:"Full Day (12h)", status:"completed", amount:780000 },
            ]);

            const statusColors = { confirmed:"var(--sage)", pending:"var(--amber)", completed:"var(--stone)" };
            const statusBg = { confirmed:"rgba(61,139,110,.08)", pending:"rgba(212,147,10,.08)", completed:"rgba(138,133,120,.08)" };
            const totalRevenue = bookings.filter(b=>b.status==='confirmed'||b.status==='completed').reduce((s,b)=>s+b.amount,0);

            // Simple calendar for current month
            const today = new Date();
            const year = today.getFullYear();
            const month = today.getMonth();
            const daysInMonth = new Date(year, month+1, 0).getDate();
            const firstDay = new Date(year, month, 1).getDay();
            const bookedDates = new Set(bookings.filter(b=>b.status!=='completed').map(b=>parseInt(b.date.split('-')[2])));

            const tabs = [
                { id:'overview', label:'Overview', icon:'üìä' },
                { id:'calendar', label:'Calendar', icon:'üìÖ' },
                { id:'bookings', label:'Bookings', icon:'üìã' },
                { id:'spaces', label:'My Spaces', icon:'üèõÔ∏è' },
            ];

            return (
                <div style={{maxWidth:900,margin:"0 auto",padding:"32px 24px 80px"}}>
                    <div className="fade-up" style={{marginBottom:12}}>
                        <div className="pill" style={{background:"rgba(124,92,224,.08)",color:"var(--violet)",marginBottom:16}}>üèõÔ∏è Venue Dashboard</div>
                        <div style={{display:"flex",alignItems:"center",gap:16,marginBottom:8}}>
                            <div style={{fontSize:40,width:64,height:64,borderRadius:18,background:"var(--warm)",display:"flex",alignItems:"center",justifyContent:"center"}}>{myVenue.img}</div>
                            <div>
                                <h1 style={{fontFamily:"var(--serif)",fontSize:"clamp(28px,5vw,40px)"}}>{myVenue.name}</h1>
                                <p style={{color:"var(--stone)",fontSize:15}}>{myVenue.specialty} ¬∑ {myVenue.area} ¬∑ Capacity: {myVenue.capacity}</p>
                            </div>
                        </div>
                    </div>

                    <div className="fade-up-d1" style={{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(140px,1fr))",gap:12,margin:"28px 0 36px"}}>
                        <StatCard label="Revenue" value={fmtCLP(totalRevenue)} color="var(--sage)"/>
                        <StatCard label="Bookings" value={bookings.filter(b=>b.status!=='completed').length} sub="active"/>
                        <StatCard label="Capacity" value={myVenue.capacity} sub="guests"/>
                        <StatCard label="Rating" value={"‚òÖ "+myVenue.rating} color="var(--amber)"/>
                    </div>

                    <div className="fade-up-d2" style={{display:"flex",gap:4,background:"var(--warm)",borderRadius:14,padding:4,marginBottom:32,overflowX:"auto"}}>
                        {tabs.map(t=>(<button key={t.id} onClick={()=>setTab(t.id)} style={{flex:1,padding:"12px 6px",borderRadius:10,border:"none",background:tab===t.id?"var(--card)":"transparent",fontWeight:tab===t.id?600:500,fontSize:13,color:tab===t.id?"var(--ink)":"var(--stone)",boxShadow:tab===t.id?"0 2px 8px rgba(0,0,0,.04)":"none",whiteSpace:"nowrap"}}>{t.icon} {t.label}</button>))}
                    </div>

                    {tab==='overview' && (
                        <div className="fade-up">
                            <div className="card" style={{marginBottom:20}}>
                                <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:16}}>This Month's Schedule</h3>
                                {bookings.filter(b=>b.status!=='completed').sort((a,b)=>a.date.localeCompare(b.date)).map((b,i)=>(
                                    <div key={b.id} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 16px",background:i%2===0?"var(--warm)":"transparent",borderRadius:12,marginBottom:4}}>
                                        <div style={{display:"flex",gap:12,alignItems:"center"}}>
                                            <div style={{width:44,height:44,borderRadius:12,background:b.status==='confirmed'?"rgba(61,139,110,.08)":"rgba(212,147,10,.08)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:18,fontWeight:700,fontFamily:"var(--serif)",color:b.status==='confirmed'?"var(--sage)":"var(--amber)"}}>{b.date.split('-')[2]}</div>
                                            <div>
                                                <div style={{fontWeight:600,fontSize:14}}>{b.client} ‚Äî {b.event}</div>
                                                <div style={{fontSize:12,color:"var(--stone)"}}>{b.time} ¬∑ {b.guests} guests ¬∑ {b.pkg}</div>
                                            </div>
                                        </div>
                                        <span className="pill" style={{background:statusBg[b.status],color:statusColors[b.status],fontSize:11}}>{b.status}</span>
                                    </div>
                                ))}
                            </div>
                            <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12}}>
                                <div className="card" style={{textAlign:"center"}}>
                                    <div style={{fontSize:13,color:"var(--stone)",marginBottom:8}}>Occupancy Rate</div>
                                    <div style={{fontFamily:"var(--serif)",fontSize:36,color:"var(--violet)"}}>68%</div>
                                    <div style={{fontSize:12,color:"var(--stone)"}}>this month</div>
                                </div>
                                <div className="card" style={{textAlign:"center"}}>
                                    <div style={{fontSize:13,color:"var(--stone)",marginBottom:8}}>Avg Event Size</div>
                                    <div style={{fontFamily:"var(--serif)",fontSize:36,color:"var(--rose)"}}>{Math.round(bookings.reduce((s,b)=>s+b.guests,0)/bookings.length)}</div>
                                    <div style={{fontSize:12,color:"var(--stone)"}}>guests</div>
                                </div>
                            </div>
                        </div>
                    )}

                    {tab==='calendar' && (
                        <div className="fade-up">
                            <div className="card">
                                <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24}}>
                                    <h3 style={{fontFamily:"var(--serif)",fontSize:22}}>{new Date(year,month).toLocaleDateString('en-US',{month:'long',year:'numeric'})}</h3>
                                    <div style={{display:"flex",gap:8}}>
                                        <span className="pill" style={{background:"rgba(124,92,224,.06)",fontSize:11}}><span style={{display:"inline-block",width:8,height:8,borderRadius:4,background:"var(--violet)",marginRight:4}}/>Booked</span>
                                        <span className="pill" style={{background:"rgba(212,83,106,.06)",fontSize:11}}><span style={{display:"inline-block",width:8,height:8,borderRadius:4,background:"var(--rose)",marginRight:4}}/>Today</span>
                                    </div>
                                </div>
                                <div style={{display:"grid",gridTemplateColumns:"repeat(7,1fr)",gap:6,marginBottom:8}}>
                                    {['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].map(d=>(
                                        <div key={d} style={{textAlign:"center",fontSize:11,fontWeight:600,color:"var(--stone)",padding:"8px 0"}}>{d}</div>
                                    ))}
                                </div>
                                <div style={{display:"grid",gridTemplateColumns:"repeat(7,1fr)",gap:6}}>
                                    {Array.from({length:firstDay},(_,i)=><div key={"e"+i}/>)}
                                    {Array.from({length:daysInMonth},(_,i)=>{
                                        const day=i+1;
                                        const isToday=day===today.getDate();
                                        const hasBooking=bookedDates.has(day);
                                        return (
                                            <div key={day} className={`calendar-day ${hasBooking?'has-booking':''} ${isToday?'today':''}`}>
                                                <span>{day}</span>
                                                {hasBooking && <span style={{fontSize:8,color:"var(--violet)",marginTop:2}}>‚óè</span>}
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                            <div className="card" style={{marginTop:16}}>
                                <h4 style={{fontWeight:600,fontSize:15,marginBottom:12}}>Booked Dates</h4>
                                {bookings.filter(b=>b.status!=='completed').map(b=>(
                                    <div key={b.id} style={{display:"flex",justifyContent:"space-between",padding:"10px 0",borderBottom:"1px solid var(--border)",fontSize:14}}>
                                        <span style={{fontWeight:500}}>{b.date} ‚Äî {b.client}</span>
                                        <span style={{color:"var(--stone)"}}>{b.time}</span>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    {tab==='bookings' && (
                        <div className="fade-up">
                            {bookings.map(b=>(
                                <div key={b.id} className="card" style={{marginBottom:12}}>
                                    <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12}}>
                                        <div>
                                            <div style={{fontWeight:700,fontSize:16}}>{b.client}</div>
                                            <div style={{fontSize:13,color:"var(--stone)"}}>{b.event} ¬∑ {b.guests} guests</div>
                                        </div>
                                        <span className="pill" style={{background:statusBg[b.status],color:statusColors[b.status]}}>{b.status}</span>
                                    </div>
                                    <div style={{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:12}}>
                                        <div><div style={{fontSize:11,color:"var(--stone)",fontWeight:600}}>DATE</div><div style={{fontSize:14,fontWeight:500}}>{b.date}</div></div>
                                        <div><div style={{fontSize:11,color:"var(--stone)",fontWeight:600}}>TIME</div><div style={{fontSize:14,fontWeight:500}}>{b.time}</div></div>
                                        <div><div style={{fontSize:11,color:"var(--stone)",fontWeight:600}}>PACKAGE</div><div style={{fontSize:14,fontWeight:500}}>{b.pkg}</div></div>
                                    </div>
                                    <div style={{display:"flex",justifyContent:"flex-end",alignItems:"center",padding:"12px 16px",background:"var(--warm)",borderRadius:12}}>
                                        <span style={{fontFamily:"var(--serif)",fontSize:20,fontWeight:700,color:"var(--violet)"}}>{fmtCLP(b.amount)}</span>
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}

                    {tab==='spaces' && (
                        <div className="fade-up">
                            <div className="card" style={{marginBottom:20,background:"linear-gradient(135deg,rgba(124,92,224,.04),rgba(212,83,106,.04))"}}>
                                <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:8}}>Venue Packages</h3>
                                <p style={{fontSize:14,color:"var(--stone)"}}>Your available space configurations and pricing</p>
                            </div>
                            {myVenue.packages.map((pkg,i)=>(
                                <div key={i} className="card" style={{marginBottom:12}}>
                                    <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start"}}>
                                        <div>
                                            <div style={{fontWeight:700,fontSize:16}}>{pkg.name}</div>
                                            <div style={{fontSize:14,color:"var(--stone)",marginTop:4}}>{pkg.desc}</div>
                                        </div>
                                        <div style={{fontFamily:"var(--serif)",fontSize:24,color:"var(--violet)"}}>{fmtCLP(pkg.flatRate)}</div>
                                    </div>
                                    <div style={{display:"flex",gap:8,marginTop:12}}>
                                        <div style={{padding:"8px 14px",borderRadius:10,background:"var(--warm)",fontSize:12,color:"var(--stone)",fontWeight:500}}>Capacity: {myVenue.capacity}</div>
                                        <div style={{padding:"8px 14px",borderRadius:10,background:"rgba(61,139,110,.06)",fontSize:12,color:"var(--sage)",fontWeight:500}}>Available for booking</div>
                                    </div>
                                </div>
                            ))}
                            <div className="card" style={{marginTop:16}}>
                                <h4 style={{fontWeight:600,fontSize:15,marginBottom:12}}>Venue Details</h4>
                                <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12}}>
                                    {[{l:"Location",v:myVenue.area},{l:"Price Range",v:myVenue.priceRange},{l:"Capacity",v:myVenue.capacity},{l:"Style",v:myVenue.tags.join(", ")}].map(d=>(
                                        <div key={d.l} style={{padding:12,background:"var(--warm)",borderRadius:10}}><div style={{fontSize:11,color:"var(--stone)",fontWeight:600,marginBottom:4}}>{d.l.toUpperCase()}</div><div style={{fontSize:14,fontWeight:500}}>{d.v}</div></div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        /* =========================================
           HOST DASHBOARD (with RSVP & Money Split)
           ========================================= */
        const HostDashboard = () => {
            const [tab, setTab] = useState('overview');
            const [guests, setGuests] = useState([
                { id:1, name:"Camila Rodr√≠guez", email:"camila@email.com", status:"confirmed", plusOne:true, dietary:"Vegetarian", paidAmount:0 },
                { id:2, name:"Diego Mu√±oz", email:"diego@email.com", status:"confirmed", plusOne:false, dietary:"", paidAmount:0 },
                { id:3, name:"Valentina L√≥pez", email:"val@email.com", status:"pending", plusOne:false, dietary:"Gluten-free", paidAmount:0 },
                { id:4, name:"Andr√©s Kramer", email:"andres@email.com", status:"confirmed", plusOne:true, dietary:"", paidAmount:0 },
                { id:5, name:"Sof√≠a Torres", email:"sofia@email.com", status:"declined", plusOne:false, dietary:"", paidAmount:0 },
                { id:6, name:"Mat√≠as Soto", email:"matias@email.com", status:"confirmed", plusOne:false, dietary:"Vegan", paidAmount:0 },
                { id:7, name:"Isabella Chen", email:"isabella@email.com", status:"pending", plusOne:true, dietary:"", paidAmount:0 },
                { id:8, name:"Tom√°s Herrera", email:"tomas@email.com", status:"confirmed", plusOne:false, dietary:"", paidAmount:0 },
                { id:9, name:"Fernanda Vidal", email:"fer@email.com", status:"confirmed", plusOne:true, dietary:"No shellfish", paidAmount:0 },
                { id:10, name:"Nicol√°s Parra", email:"nico@email.com", status:"pending", plusOne:false, dietary:"", paidAmount:0 },
            ]);
            const [newGuestName, setNewGuestName] = useState('');
            const [newGuestEmail, setNewGuestEmail] = useState('');
            const [toast, setToast] = useState(null);
            const [splitMethod, setSplitMethod] = useState('equal'); // equal, custom, proportional
            const [totalEventCost, setTotalEventCost] = useState(2500000);
            const [splitIncludeDeclined, setSplitIncludeDeclined] = useState(false);

            const showToast=(msg)=>{setToast(msg);setTimeout(()=>setToast(null),2500);};

            const confirmed = guests.filter(g=>g.status==='confirmed');
            const pending = guests.filter(g=>g.status==='pending');
            const declined = guests.filter(g=>g.status==='declined');
            const totalAttending = confirmed.reduce((s,g)=>s+(g.plusOne?2:1),0);
            const totalPending = pending.reduce((s,g)=>s+(g.plusOne?2:1),0);

            const updateGuestStatus=(id,status)=>{setGuests(p=>p.map(g=>g.id===id?{...g,status}:g));showToast("Updated!");};
            const updateGuestPaid=(id,amount)=>{setGuests(p=>p.map(g=>g.id===id?{...g,paidAmount:Math.max(0,parseInt(amount)||0)}:g));};

            const addGuest=()=>{
                if(!newGuestName.trim()) return;
                setGuests(p=>[...p,{id:Date.now(),name:newGuestName.trim(),email:newGuestEmail.trim(),status:'pending',plusOne:false,dietary:'',paidAmount:0}]);
                setNewGuestName('');setNewGuestEmail('');showToast("Guest added!");
            };

            const togglePlusOne=(id)=>{setGuests(p=>p.map(g=>g.id===id?{...g,plusOne:!g.plusOne}:g));};

            // Money split calculations
            const splitGuests = splitIncludeDeclined ? guests : guests.filter(g=>g.status!=='declined');
            const splitHeadCount = splitGuests.reduce((s,g)=>s+(g.plusOne?2:1),0);
            const perPersonCost = splitHeadCount > 0 ? Math.ceil(totalEventCost / splitHeadCount) : 0;
            const totalPaid = guests.reduce((s,g)=>s+g.paidAmount,0);
            const remaining = totalEventCost - totalPaid;

            const statusColors = { confirmed:"var(--sage)", pending:"var(--amber)", declined:"var(--rose)" };
            const statusBg = { confirmed:"rgba(61,139,110,.08)", pending:"rgba(212,147,10,.08)", declined:"rgba(212,83,106,.08)" };
            const statusIcon = { confirmed:"‚úì", pending:"‚óØ", declined:"‚úó" };

            const tabs = [
                { id:'overview', label:'Overview', icon:'üìä' },
                { id:'rsvp', label:'RSVP Tracker', icon:'üìã' },
                { id:'split', label:'Money Split', icon:'üí∞' },
                { id:'share', label:'Share & Invite', icon:'üí¨' },
            ];

            return (
                <div style={{maxWidth:900,margin:"0 auto",padding:"32px 24px 80px"}}>
                    <div className="fade-up" style={{marginBottom:12}}>
                        <div className="pill" style={{background:"rgba(61,139,110,.08)",color:"var(--sage)",marginBottom:16}}>üéâ Host Dashboard</div>
                        <h1 style={{fontFamily:"var(--serif)",fontSize:"clamp(28px,5vw,40px)",marginBottom:8}}>Your Event Command Center</h1>
                        <p style={{color:"var(--stone)",fontSize:15}}>Track RSVPs, manage guests, and split costs ‚Äî all in one place.</p>
                    </div>

                    <div className="fade-up-d1" style={{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(130px,1fr))",gap:12,margin:"28px 0 36px"}}>
                        <StatCard label="Confirmed" value={totalAttending} sub={`${confirmed.length} guests`} color="var(--sage)"/>
                        <StatCard label="Pending" value={totalPending} sub={`${pending.length} guests`} color="var(--amber)"/>
                        <StatCard label="Declined" value={declined.length} color="var(--rose)"/>
                        <StatCard label="Total Cost" value={fmtCLP(totalEventCost)} sub="CLP"/>
                    </div>

                    <div className="fade-up-d2" style={{display:"flex",gap:4,background:"var(--warm)",borderRadius:14,padding:4,marginBottom:32,overflowX:"auto"}}>
                        {tabs.map(t=>(<button key={t.id} onClick={()=>setTab(t.id)} style={{flex:1,padding:"12px 6px",borderRadius:10,border:"none",background:tab===t.id?"var(--card)":"transparent",fontWeight:tab===t.id?600:500,fontSize:13,color:tab===t.id?"var(--ink)":"var(--stone)",boxShadow:tab===t.id?"0 2px 8px rgba(0,0,0,.04)":"none",whiteSpace:"nowrap"}}>{t.icon} {t.label}</button>))}
                    </div>

                    {/* Overview */}
                    {tab==='overview' && (
                        <div className="fade-up">
                            <div className="card" style={{marginBottom:20}}>
                                <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:20}}>RSVP Summary</h3>
                                <div style={{display:"flex",gap:8,marginBottom:20}}>
                                    {[{label:"Confirmed",count:confirmed.length,heads:totalAttending,color:"var(--sage)"},{label:"Pending",count:pending.length,heads:totalPending,color:"var(--amber)"},{label:"Declined",count:declined.length,heads:declined.length,color:"var(--rose)"}].map(s=>(
                                        <div key={s.label} style={{flex:1,padding:16,borderRadius:14,background:`${s.color}11`,textAlign:"center"}}>
                                            <div style={{fontSize:28,fontWeight:700,fontFamily:"var(--serif)",color:s.color}}>{s.heads}</div>
                                            <div style={{fontSize:12,color:"var(--stone)"}}>{s.label} ({s.count} {s.count===1?'guest':'guests'})</div>
                                        </div>
                                    ))}
                                </div>
                                {/* Progress bar */}
                                <div style={{background:"var(--border)",borderRadius:8,height:12,overflow:"hidden",display:"flex"}}>
                                    <div style={{width:`${(totalAttending/(totalAttending+totalPending+declined.length))*100}%`,background:"var(--sage)",transition:"width .3s"}}/>
                                    <div style={{width:`${(totalPending/(totalAttending+totalPending+declined.length))*100}%`,background:"var(--amber)",transition:"width .3s"}}/>
                                    <div style={{width:`${(declined.length/(totalAttending+totalPending+declined.length))*100}%`,background:"var(--rose)",transition:"width .3s"}}/>
                                </div>
                            </div>

                            <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:20}}>
                                <div className="card" onClick={()=>setTab('rsvp')} style={{cursor:"pointer",borderColor:"rgba(61,139,110,.12)",padding:20}}>
                                    <span style={{fontSize:28}}>üìã</span>
                                    <div style={{fontWeight:700,fontSize:14,marginTop:8}}>RSVP Tracker</div>
                                    <div style={{fontSize:12,color:"var(--stone)",marginTop:2}}>Manage all guest responses</div>
                                </div>
                                <div className="card" onClick={()=>setTab('split')} style={{cursor:"pointer",borderColor:"rgba(124,92,224,.12)",padding:20}}>
                                    <span style={{fontSize:28}}>üí∞</span>
                                    <div style={{fontWeight:700,fontSize:14,marginTop:8}}>Money Split</div>
                                    <div style={{fontSize:12,color:"var(--stone)",marginTop:2}}>Split costs among guests</div>
                                </div>
                            </div>

                            <div className="card">
                                <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:16}}>Payment Progress</h3>
                                <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12}}>
                                    <span style={{fontSize:14,color:"var(--stone)"}}>Collected</span>
                                    <span style={{fontWeight:700,color:"var(--sage)"}}>{fmtCLP(totalPaid)}</span>
                                </div>
                                <div style={{background:"var(--border)",borderRadius:8,height:8,overflow:"hidden",marginBottom:12}}>
                                    <div style={{width:`${totalEventCost>0?(totalPaid/totalEventCost)*100:0}%`,background:"var(--sage)",height:"100%",borderRadius:8,transition:"width .3s"}}/>
                                </div>
                                <div style={{display:"flex",justifyContent:"space-between",fontSize:13,color:"var(--stone)"}}>
                                    <span>Remaining: {fmtCLP(remaining)}</span>
                                    <span>{totalEventCost>0?Math.round((totalPaid/totalEventCost)*100):0}% collected</span>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* RSVP Tracker */}
                    {tab==='rsvp' && (
                        <div className="fade-up">
                            {/* Add guest */}
                            <div className="card" style={{marginBottom:20}}>
                                <h3 style={{fontFamily:"var(--serif)",fontSize:20,marginBottom:16}}>Add Guest</h3>
                                <div style={{display:"flex",gap:10,flexWrap:"wrap"}}>
                                    <input value={newGuestName} onChange={e=>setNewGuestName(e.target.value)} placeholder="Guest name" style={{flex:2,minWidth:160}}/>
                                    <input value={newGuestEmail} onChange={e=>setNewGuestEmail(e.target.value)} placeholder="Email (optional)" style={{flex:2,minWidth:160}}/>
                                    <button onClick={addGuest} style={{padding:"14px 24px",borderRadius:14,border:"none",background:"var(--ink)",color:"#fff",fontWeight:600,fontSize:14,whiteSpace:"nowrap"}}>+ Add</button>
                                </div>
                            </div>

                            {/* Guest filters */}
                            <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}}>
                                <div style={{fontSize:14,color:"var(--stone)",fontWeight:500}}>{guests.length} guests total ¬∑ {totalAttending} attending</div>
                            </div>

                            {/* Guest list */}
                            {['confirmed','pending','declined'].map(status=>{
                                const group = guests.filter(g=>g.status===status);
                                if(group.length===0) return null;
                                return (
                                    <div key={status} style={{marginBottom:24}}>
                                        <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:12}}>
                                            <div className="status-dot" style={{background:statusColors[status]}}/>
                                            <h4 style={{fontSize:15,fontWeight:600,textTransform:"capitalize"}}>{status} ({group.length})</h4>
                                        </div>
                                        {group.map(g=>(
                                            <div key={g.id} className="rsvp-row">
                                                <div style={{width:36,height:36,borderRadius:10,background:statusBg[g.status],display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:statusColors[g.status],flexShrink:0}}>{statusIcon[g.status]}</div>
                                                <div style={{flex:1,minWidth:0}}>
                                                    <div style={{fontWeight:600,fontSize:14}}>{g.name}{g.plusOne?" +1":""}</div>
                                                    <div style={{fontSize:12,color:"var(--stone)"}}>{g.email}{g.dietary?` ¬∑ ${g.dietary}`:""}</div>
                                                </div>
                                                <div style={{display:"flex",gap:6,flexShrink:0}}>
                                                    <button onClick={()=>togglePlusOne(g.id)} style={{padding:"6px 10px",borderRadius:8,border:"1px solid var(--border)",background:g.plusOne?"rgba(124,92,224,.06)":"transparent",fontSize:11,fontWeight:600,color:g.plusOne?"var(--violet)":"var(--stone)"}}>+1</button>
                                                    {g.status!=='confirmed'&&<button onClick={()=>updateGuestStatus(g.id,'confirmed')} style={{padding:"6px 10px",borderRadius:8,border:"none",background:"rgba(61,139,110,.08)",fontSize:11,fontWeight:600,color:"var(--sage)"}}>‚úì</button>}
                                                    {g.status!=='pending'&&<button onClick={()=>updateGuestStatus(g.id,'pending')} style={{padding:"6px 10px",borderRadius:8,border:"none",background:"rgba(212,147,10,.08)",fontSize:11,fontWeight:600,color:"var(--amber)"}}>‚óØ</button>}
                                                    {g.status!=='declined'&&<button onClick={()=>updateGuestStatus(g.id,'declined')} style={{padding:"6px 10px",borderRadius:8,border:"none",background:"rgba(212,83,106,.08)",fontSize:11,fontWeight:600,color:"var(--rose)"}}>‚úó</button>}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                );
                            })}
                        </div>
                    )}

                    {/* Money Split */}
                    {tab==='split' && (
                        <div className="fade-up">
                            {/* Total cost input */}
                            <div className="card" style={{marginBottom:20,background:"linear-gradient(135deg,rgba(124,92,224,.04),rgba(212,83,106,.04))"}}>
                                <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:16}}>Cost Splitting</h3>
                                <div style={{display:"flex",gap:16,alignItems:"flex-end",flexWrap:"wrap",marginBottom:16}}>
                                    <div style={{flex:1,minWidth:200}}>
                                        <label style={{fontWeight:600,fontSize:14,display:"block",marginBottom:8}}>Total Event Cost (CLP)</label>
                                        <input type="number" value={totalEventCost} onChange={e=>setTotalEventCost(parseInt(e.target.value)||0)} style={{fontSize:18,fontWeight:600}}/>
                                    </div>
                                    <div style={{flex:1,minWidth:200}}>
                                        <label style={{fontWeight:600,fontSize:14,display:"block",marginBottom:8}}>Split Method</label>
                                        <div style={{display:"flex",gap:6}}>
                                            {[{v:'equal',l:'Equal Split'},{v:'custom',l:'Custom'}].map(m=>(
                                                <Chip key={m.v} selected={splitMethod===m.v} onClick={()=>setSplitMethod(m.v)}>{m.l}</Chip>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                                <label style={{display:"flex",alignItems:"center",gap:8,fontSize:13,color:"var(--stone)",cursor:"pointer"}}>
                                    <div className={`custom-check ${splitIncludeDeclined?'checked':''}`} onClick={()=>setSplitIncludeDeclined(!splitIncludeDeclined)} style={{width:18,height:18}}>
                                        {splitIncludeDeclined&&<svg width="12" height="12" viewBox="0 0 14 14" fill="none"><path d="M3 7L6 10L11 4" stroke="#fff" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/></svg>}
                                    </div>
                                    Include declined guests in split
                                </label>
                            </div>

                            {/* Split summary */}
                            <div style={{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:20}}>
                                <div className="card" style={{textAlign:"center",padding:20}}>
                                    <div style={{fontSize:13,color:"var(--stone)",marginBottom:6}}>Per Person</div>
                                    <div style={{fontFamily:"var(--serif)",fontSize:24,color:"var(--violet)"}}>{fmtCLP(perPersonCost)}</div>
                                    <div style={{fontSize:11,color:"var(--stone)"}}>{splitHeadCount} heads</div>
                                </div>
                                <div className="card" style={{textAlign:"center",padding:20}}>
                                    <div style={{fontSize:13,color:"var(--stone)",marginBottom:6}}>Collected</div>
                                    <div style={{fontFamily:"var(--serif)",fontSize:24,color:"var(--sage)"}}>{fmtCLP(totalPaid)}</div>
                                    <div style={{fontSize:11,color:"var(--stone)"}}>{totalEventCost>0?Math.round((totalPaid/totalEventCost)*100):0}%</div>
                                </div>
                                <div className="card" style={{textAlign:"center",padding:20}}>
                                    <div style={{fontSize:13,color:"var(--stone)",marginBottom:6}}>Remaining</div>
                                    <div style={{fontFamily:"var(--serif)",fontSize:24,color:remaining>0?"var(--rose)":"var(--sage)"}}>{fmtCLP(remaining)}</div>
                                    <div style={{fontSize:11,color:"var(--stone)"}}>{remaining<=0?"All paid!":"outstanding"}</div>
                                </div>
                            </div>

                            {/* Per-guest breakdown */}
                            <div className="card">
                                <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}}>
                                    <h3 style={{fontFamily:"var(--serif)",fontSize:20}}>Guest Breakdown</h3>
                                    <button onClick={()=>{const t=guests.map(g=>{const owe=g.plusOne?perPersonCost*2:perPersonCost;const bal=owe-g.paidAmount;return `${g.name}: owes ${fmtCLP(owe)}${g.paidAmount>0?`, paid ${fmtCLP(g.paidAmount)}, balance: ${fmtCLP(bal)}`:''}`}).join('\n');navigator.clipboard.writeText(`üí∞ Cost Split - ${fmtCLP(totalEventCost)} total\nPer person: ${fmtCLP(perPersonCost)}\n\n${t}`);showToast("Copied!");}} style={{padding:"8px 16px",borderRadius:10,border:"1px solid var(--border)",background:"transparent",fontSize:12,fontWeight:600}}>üìã Copy Split</button>
                                </div>
                                <div style={{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:8,padding:"8px 16px",marginBottom:8}}>
                                    <div style={{fontSize:11,color:"var(--stone)",fontWeight:600}}>GUEST</div>
                                    <div style={{fontSize:11,color:"var(--stone)",fontWeight:600,textAlign:"center"}}>OWES</div>
                                    <div style={{fontSize:11,color:"var(--stone)",fontWeight:600,textAlign:"center"}}>PAID</div>
                                    <div style={{fontSize:11,color:"var(--stone)",fontWeight:600,textAlign:"center"}}>BALANCE</div>
                                </div>
                                {splitGuests.map(g=>{
                                    const owes = splitMethod==='equal' ? (g.plusOne?perPersonCost*2:perPersonCost) : g.paidAmount;
                                    const balance = (splitMethod==='equal'?(g.plusOne?perPersonCost*2:perPersonCost):0)-g.paidAmount;
                                    return (
                                        <div key={g.id} style={{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:8,padding:"12px 16px",alignItems:"center",borderRadius:10,background:balance<=0&&g.paidAmount>0?"rgba(61,139,110,.03)":"transparent"}}>
                                            <div>
                                                <span style={{fontWeight:500,fontSize:14}}>{g.name}</span>
                                                {g.plusOne&&<span style={{fontSize:11,color:"var(--violet)",marginLeft:6}}>+1</span>}
                                                <span className="pill" style={{background:statusBg[g.status],color:statusColors[g.status],fontSize:10,marginLeft:6,padding:"2px 8px"}}>{g.status}</span>
                                            </div>
                                            <div style={{textAlign:"center",fontSize:14,fontWeight:500}}>{splitMethod==='equal'?fmtCLP(g.plusOne?perPersonCost*2:perPersonCost):'‚Äî'}</div>
                                            <div style={{textAlign:"center"}}>
                                                {splitMethod==='custom'||splitMethod==='equal'?(
                                                    <input type="number" value={g.paidAmount||''} onChange={e=>updateGuestPaid(g.id,e.target.value)} placeholder="0" className="split-input" style={{border:`1.5px solid ${g.paidAmount>0?"var(--sage)":"var(--border)"}`,color:g.paidAmount>0?"var(--sage)":"var(--ink)"}}/>
                                                ):<span style={{fontSize:14}}>{fmtCLP(g.paidAmount)}</span>}
                                            </div>
                                            <div style={{textAlign:"center",fontSize:14,fontWeight:600,color:balance>0?"var(--rose)":balance===0&&g.paidAmount===0?"var(--stone)":"var(--sage)"}}>
                                                {splitMethod==='equal'?(balance>0?fmtCLP(balance):g.paidAmount>0?"Paid ‚úì":"‚Äî"):"‚Äî"}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>
                    )}

                    {/* Share & Invite */}
                    {tab==='share' && (
                        <div className="fade-up">
                            <div className="card" style={{marginBottom:20}}>
                                <h3 style={{fontFamily:"var(--serif)",fontSize:22,marginBottom:16}}>Share Event Details</h3>
                                <p style={{fontSize:14,color:"var(--stone)",marginBottom:20}}>Send invitations and share your event info via WhatsApp.</p>
                                <div style={{display:"flex",flexDirection:"column",gap:12}}>
                                    <button onClick={()=>{const msg=`üéâ *You're Invited!*\n\nGuest count so far: ${totalAttending} confirmed\nPending: ${pending.length} guests\n\nPlease RSVP as soon as possible!`;window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`,'_blank');}} style={{padding:"14px 24px",borderRadius:14,border:"none",background:"#25D366",color:"#fff",fontWeight:600,fontSize:15,display:"flex",alignItems:"center",justifyContent:"center",gap:8}}>üí¨ Send Invite via WhatsApp</button>
                                    <button onClick={()=>{const summary=`üìä *RSVP Status Update*\n\n‚úÖ Confirmed: ${confirmed.length} guests (${totalAttending} total with +1s)\n‚è≥ Pending: ${pending.length} guests\n‚ùå Declined: ${declined.length} guests\n\nüí∞ Cost per person: ${fmtCLP(perPersonCost)}\n\nPlease respond if you haven't yet!`;window.open(`https://wa.me/?text=${encodeURIComponent(summary)}`,'_blank');}} style={{padding:"14px 24px",borderRadius:14,border:"1.5px solid var(--border)",background:"transparent",fontWeight:600,fontSize:15,display:"flex",alignItems:"center",justifyContent:"center",gap:8}}>üìä Share RSVP Status</button>
                                    <button onClick={()=>{const splitMsg=`üí∞ *Cost Split Update*\n\nTotal: ${fmtCLP(totalEventCost)}\nPer person: ${fmtCLP(perPersonCost)}\n\n${splitGuests.map(g=>{const owe=g.plusOne?perPersonCost*2:perPersonCost;return `${g.name}: ${fmtCLP(owe)}${g.paidAmount>0?` (paid ${fmtCLP(g.paidAmount)})`:''}`}).join('\n')}\n\nCollected: ${fmtCLP(totalPaid)} / ${fmtCLP(totalEventCost)}`;window.open(`https://wa.me/?text=${encodeURIComponent(splitMsg)}`,'_blank');}} style={{padding:"14px 24px",borderRadius:14,border:"1.5px solid var(--border)",background:"transparent",fontWeight:600,fontSize:15,display:"flex",alignItems:"center",justifyContent:"center",gap:8}}>üí∞ Share Cost Split</button>
                                </div>
                            </div>
                            <div className="card">
                                <h3 style={{fontFamily:"var(--serif)",fontSize:20,marginBottom:16}}>Guest Contact List</h3>
                                {guests.map(g=>(
                                    <div key={g.id} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 0",borderBottom:"1px solid var(--border)"}}>
                                        <div><div style={{fontWeight:500,fontSize:14}}>{g.name}</div><div style={{fontSize:12,color:"var(--stone)"}}>{g.email||"No email"}</div></div>
                                        <span className="pill" style={{background:statusBg[g.status],color:statusColors[g.status],fontSize:11}}>{g.status}</span>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    <Toast message={toast} visible={!!toast}/>
                </div>
            );
        };

        /* =========================================
          /* =========================================
   APP
   ========================================= */
function App() {
  const [view, setView] = useState('landing');
  const [formData, setFormData] = useState(null);
  const [blueprint, setBlueprint] = useState(null);
  const [vendors, setVendors] = useState(null);
  const [genError, setGenError] = useState('');

  const handleGenerate = useCallback(async (data) => {
    setFormData(data);
    setView('loading');
    setGenError('');

    const matched = matchVendors(data);
    setVendors(matched);

    let bp;
    try {
      bp = await generateBlueprint(data);
      // Expect the server to return a full blueprint object with timeline, supplies, and blueprint text
      const hasTimeline = bp && Array.isArray(bp.timeline) && bp.timeline.length;
      const hasText = bp && typeof bp.blueprint === "string" && bp.blueprint.trim().length;
      if (!bp || (!hasTimeline && !hasText)) throw new Error('Invalid blueprint response');
    } catch (e) {
      setGenError(e.message || 'Blueprint generation failed ‚Äî using fallback');
      bp = generateFallback(data);
    }

    // Store the entire object (including bp.blueprint) in state
    setBlueprint(bp);
    setView('blueprint');
  }, []);

  return (
    <div>
      <Nav view={view} setView={setView} />
      {view === 'landing' && <Landing onStart={() => setView('onboarding')} />}
      {view === 'onboarding' && <Onboarding onFinish={handleGenerate} />}
      {view === 'loading' && <Loading error={genError} />}
      {view === 'blueprint' && blueprint && (
        <Blueprint data={formData} blueprint={blueprint} vendors={vendors} />
      )}
      {view === 'vendor-dashboard' && <VendorDashboard />}
      {view === 'venue-dashboard' && <VenueDashboard />}
      {view === 'host-dashboard' && <HostDashboard />}
    </div>
  );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
    </script>
    <div id="party-debug" style="white-space: pre-wrap; font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif; font-size: 13px; margin-top: 24px; padding: 12px 16px; border-top: 1px solid #eee;"></div>

<script>
  async function loadCatalog() {
    const outputEl = document.getElementById('party-debug');

    try {
      const res = await fetch('/data/party_catalog_v4.json');
      if (!res.ok) {
        throw new Error('HTTP ' + res.status + ' ' + res.statusText);
      }

      const catalog = await res.json();

      const lines = [];
      lines.push('Party catalog loaded ‚úÖ');
      lines.push('');
      lines.push('Version: ' + catalog.version);
      lines.push('Currency: ' + catalog.currency);
      lines.push('');
      lines.push('Stores:');
      (catalog.stores || []).forEach(store => {
        lines.push('- ' + store.name + ' (' + store.id + ')');
      });

      lines.push('');
      lines.push('Sample items for adult birthday at home (up to 5):');

      const birthdayItems = (catalog.items || [])
        .filter(item => Array.isArray(item.useCases) && item.useCases.includes('adult_birthday_home'))
        .slice(0, 5);

      birthdayItems.forEach(item => {
        const price = item.price && item.price.amount
          ? '$' + item.price.amount.toLocaleString('es-CL')
          : 'precio a cotizar';
        lines.push('‚Ä¢ [' + item.storeId + '] ' + item.name + ' ‚Äî ' + price);
      });

      outputEl.textContent = lines.join('\n');
    } catch (err) {
      console.error('Error loading party catalog:', err);
      if (outputEl) {
        outputEl.textContent = 'Error loading /data/party_catalog_v4.json: ' + err.message;
      }
    }
  }

  document.addEventListener('DOMContentLoaded', loadCatalog);
</script>

</body>
</html>
